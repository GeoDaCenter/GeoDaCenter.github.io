<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Luc Anselin" />


<title>Local Spatial Autocorrelation (3)</title>

<script src="lab6c_files/header-attrs-2.3/header-attrs.js"></script>
<link href="lab6c_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="lab6c_files/highlightjs-9.12.0/highlight.js"></script>
    <title>GeoDa on Github</title>

    <style>
    	*{margin:0;padding:0;}
	    .shadowfilter {
	       -webkit-filter: drop-shadow(12px 12px 7px rgba(0,0,0,0.5));
	        filter: url(shadow.svg#drop-shadow);
	     }
	     .intro1 { margin-left: -45px;}
    </style>
    <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" href="https://geodacenter.github.io/stylesheets/simple-slideshow-styles.css">
    <style>
    ul {padding-left:30px;}
	figcaption {
	  top: .70em;
   	  left: .35em;
 	  bottom: auto!important;
	  right: auto!important;
	}
    </style>

        <style>
    h1 {
        text-align: center;
    }
    h3.subtitle {
        text-align: center;
    }
    h4.author {
        text-align: center;
    }
    h4.date {
        text-align: center;
    }
    p.caption {
        font-size : 12px;
    }
    </style>

<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72724100-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53RVF8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-53RVF8');</script>
<!-- End Google Tag Manager -->

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








</head>

<body>


    <section class="page-header">
      <h1 class="project-name">GeoDa</h1>
      <h2 class="project-tagline">An Introduction to Spatial Data Analysis</h2>
      <a href="https://geodacenter.github.io/index.html" class="btn">Homepage</a>
      <a href="https://geodacenter.github.io/download.html" class="btn">Download</a>
      <a href="https://github.com/GeoDaCenter/geoda/" class="btn">View on GitHub</a>
      <a href="https://spatial.uchicago.edu/sample-data"  target="_blank" class="btn">Data</a>
       <a href="https://geodacenter.github.io/documentation.html" class="btn">Documentation</a>
       <a href="https://geodacenter.github.io/support.html" class="btn">Support</a>
       <a href="https://geodacenter.github.io/index-cn.html" class="btn">中文</a>
    </section>

    <section class="main-content">


<h1 class="title toc-ignore">Local Spatial Autocorrelation (3)</h1>
<h3 class="subtitle">Multivariate Local Spatial Autocorrelation</h3>
<h4 class="author">Luc Anselin<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h4>
<h4 class="date">10/15/2020 (updated)</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#objectives">Objectives</a>
<ul>
<li><a href="#geoda-functions-covered">GeoDa functions covered</a></li>
</ul></li>
<li><a href="#preliminaries">Preliminaries</a></li>
</ul></li>
<li><a href="#the-multivariate-spatial-autocorrelation-problem">The Multivariate Spatial Autocorrelation Problem</a></li>
<li><a href="#bivariate-local-moran">Bivariate Local Moran</a>
<ul>
<li><a href="#principle">Principle</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#interpretation">Interpretation</a></li>
</ul></li>
<li><a href="#multivariate-local-geary">Multivariate Local Geary</a>
<ul>
<li><a href="#principle-1">Principle</a></li>
<li><a href="#implementation-1">Implementation</a>
<ul>
<li><a href="#univariate-analysis-of-multiple-variables">Univariate analysis of multiple variables</a></li>
<li><a href="#multivariate-analysis">Multivariate analysis</a></li>
</ul></li>
<li><a href="#interpretation-1">Interpretation</a>
<ul>
<li><a href="#multivariate-clusters-and-3d-scatter-plot">Multivariate clusters and 3D scatter plot</a></li>
<li><a href="#multivariate-clusters-and-pcp">Multivariate clusters and PCP</a></li>
</ul></li>
</ul></li>
<li><a href="#local-neighbor-match-test">Local Neighbor Match Test</a>
<ul>
<li><a href="#principle-2">Principle</a></li>
<li><a href="#implementation-2">Implementation</a>
<ul>
<li><a href="#intersection-between-connectivity-graphs">Intersection between connectivity graphs</a></li>
<li><a href="#testing-the-local-neighbor-match">Testing the local neighbor match</a></li>
<li><a href="#significance">Significance</a></li>
<li><a href="#local-neighbor-match-and-multivariate-local-geary">Local neighbor match and Multivariate Local Geary</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p><br></p>
<div id="introduction" class="section level2 unnumbered" number="">
<h2>Introduction</h2>
<p>In this chapter, we cover the extension of the concept of local spatial autocorrelation to
the multivariate domain. This turns out to be particularly challenging due to the difficulty
in separating pure attribute correlation among multiple variables from the spatial effects.</p>
<p>We consider three methods. First, we discuss a bivariate version of the Local Moran, which
is useful in a space-time context, but needs to be interpreted with great caution in pure
cross-sectional settings. We next outline an extension of the Local Geary statistic to the
multivariate Local Geary. We close with a discussion of a recently introduced
<em>local neighbor match test</em>.</p>
<p>As in the previous Chapter, we continue to use both the <strong>natregimes</strong> and the <strong>Guerry</strong> data
sets to illustrate these methods.</p>
<div id="objectives" class="section level3 unnumbered" number="">
<h3>Objectives</h3>
<ul>
<li><p>Understand the issues related to extending a spatial autocorrelation measure
to a multivariate setting</p></li>
<li><p>Identify clusters and outliers with the bivariate extensions
of the Local Moran statistic</p></li>
<li><p>Identify clusters and outliers with the Multivariate Local Geary</p></li>
<li><p>Understand the issues pertaining to interpreting the results of the multivariate Local Geary</p></li>
<li><p>Identify clusters by means of the local neighbor match test</p></li>
</ul>
<div id="geoda-functions-covered" class="section level4 unnumbered" number="">
<h4>GeoDa functions covered</h4>
<ul>
<li>Space &gt; Bivariate Local Moran’s I</li>
<li>Space &gt; Multivariate Local Geary</li>
<li>Space &gt; Local Neighbor Match Test</li>
</ul>
<p><br></p>
</div>
</div>
<div id="preliminaries" class="section level3 unnumbered" number="">
<h3>Preliminaries</h3>
<p>As in the previous Chapter, we will continue to use both
the <strong>Guerry</strong> data set and the <strong>natregimes</strong> data set. For each of
these, we need an active spatial weights matrix, e.g., <strong>guerry_85_q</strong> for the former and <strong>natregimes_q</strong> for
the latter. See the description in earlier Chapters on how to accomplish this.</p>
<p>Also, as in the previous Chapter, we need some further preparation of the <strong>natregimes</strong> data set to make the variables time sensitive. If not done so already, we need to use
the <strong>Time Editor</strong> to group the homicide rates <strong>hr60</strong> through <strong>hr90</strong>
into the variable <strong>hr</strong> (we do not need the count variables in this Chapter).</p>
</div>
</div>
<div id="the-multivariate-spatial-autocorrelation-problem" class="section level2 unnumbered" number="">
<h2>The Multivariate Spatial Autocorrelation Problem</h2>
<p>Designing a spatial autocorrelation statistic in a multivariate setting is fraught with difficulty.
The most common statistic, Moran’s I, is based on a cross-product association, which is the same
as a bivariate correlation statistic. As a result, it is difficult to disentangle whether the correlation
between multiple variables at adjoining locations is due to the correlation among the variables, or
a similarity due to being neighbors in space.</p>
<p>Early attempts at extending Moran’s I to multiple variables focused on principal components, as in
the suggestion by <span class="citation">Wartenberg (<a href="#ref-Wartenberg:85" role="doc-biblioref">1985</a>)</span>, and later work by <span class="citation">Dray, Saïd, and Débias (<a href="#ref-Drayetal:08" role="doc-biblioref">2008</a>)</span>. However, these proposals only
dealt with a global statistic. A more local perspective along the same lines is presented in <span class="citation">Lin (<a href="#ref-Lin:20" role="doc-biblioref">2020</a>)</span>,
although it is primarily a special case of a geographically weighted regression, or GWR <span class="citation">(Fotheringham, Brunsdon, and Charlton <a href="#ref-Fotheringhametal:02" role="doc-biblioref">2002</a>)</span>.</p>
<p><span class="citation">Lee (<a href="#ref-LeeS:01" role="doc-biblioref">2001</a>)</span> outlined a way to separate a bivariate Moran-like spatial correlation coefficient into
a spatial part and a Pearson correlation coefficient. However, this relies on some fairly strong
simplifying assumptions that may not be realistic in practice.</p>
<p>In <span class="citation">Anselin (<a href="#ref-Anselin:18" role="doc-biblioref">2019</a>)</span>, the idea is proposed to focus on the distance between observations in both attribute and
geographical space and to construct statistics that assess the match between those distances. In general,
the squared multi-attribute distance between a pair of observations <span class="math inline">\(i, j\)</span> on <span class="math inline">\(k\)</span> variables is given as:
<span class="math display">\[d_{ij}^2 = || x_i - x_j || = \sum_{h=1}^k (x_{ih} - x_{jh})^2,\]</span>
with <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span> as vectors of observations. In some expressions, the squared distance will be preferred,
in others, the actual distance (<span class="math inline">\(d_{ij}\)</span>, its square root) will be used. The overall idea is to identify observations
that are both <em>close</em> in multiattribute space and close in geographical space.</p>
<p>First, we consider a simple bivariate extension of the Local Moran, which is not based on the distance measures.</p>
</div>
<div id="bivariate-local-moran" class="section level2 unnumbered" number="">
<h2>Bivariate Local Moran</h2>
<div id="principle" class="section level3 unnumbered" number="">
<h3>Principle</h3>
<p>The treatment of the bivariate Local Moran’s I closely follows that of its
global counterpart <span class="citation">(see also Anselin, Syabri, and Smirnov <a href="#ref-Anselinetal:02b" role="doc-biblioref">2002</a>)</span>. In essence, it captures the relationship between the value
for one variable at location <span class="math inline">\(i\)</span>, <span class="math inline">\(x_i\)</span>, and the average of the neighboring values for
<em>another variable</em>, i.e., its spatial lag <span class="math inline">\(\sum_j w_{ij} y_j\)</span>. Apart from a constant scaling factor (that
can be ignored), the statistic is the product of <span class="math inline">\(x_i\)</span> with the
spatial lag of <span class="math inline">\(y_i\)</span> (i.e., <span class="math inline">\(\sum_j w_{ij}y_j\)</span>), with both variables standardized, such that their
means are zero and variances equal one:</p>
<p><span class="math display">\[ I_{i}^B = c x_i \sum_j w_{ij} y_j,\]</span>
where <span class="math inline">\(w_{ij}\)</span> are the elements of the spatial weights matrix.</p>
<p>As is the case for its global counterpart, this statistic needs to be interpreted with caution, since it ignores in-situ correlation between the two variables (see the discussion of global bivariate spatial autocorrelation for details).</p>
<p>A special case of the bivariate Local Moran statistic is comparing the same variable at two points in time. The most meaningful application is where one variable is for time period <span class="math inline">\(t\)</span>, say <span class="math inline">\(z_t\)</span>, and the other variable is for the neighbors in the previous time period, say <span class="math inline">\(z_{t-1}\)</span>. This formulation measures the extent to which the value at a location in a given time period is correlated with the values at neighboring locations in a previous time period, or an inward influence. It is illustrated in the example below.</p>
<p>An alternative view is to consider <span class="math inline">\(z_{t-1}\)</span> and the neighbors at the current time. This would measure the correlation
between a location and its neighbors at a later time, or an outward influence. The first specification is more accepted, as
it fits within a standard space-time regression framework.</p>
</div>
<div id="implementation" class="section level3 unnumbered" number="">
<h3>Implementation</h3>
<p>The bivariate Local Moran functionality is invoked from the first group in the <strong>Cluster Maps</strong> toolbar icon, as show
in Figure <a href="#fig:bivariatelisa">1</a>,
or from the menu as <strong>Space &gt; Bivariate Local Moran’s I</strong>.</p>
<div class="figure" style="text-align: center"><span id="fig:bivariatelisa"></span>
<img src="pics6c/11_bilisa_menu.png" alt="Bivariate Local Moran from the toolbar" width="20%" />
<p class="caption">
Figure 1: Bivariate Local Moran from the toolbar
</p>
</div>
<p>Next, we proceed in the usual fashion by selecting a variable for <span class="math inline">\(x\)</span>, for example
<strong>hr(90)</strong>, and a variable for <span class="math inline">\(y\)</span>, say <strong>hr(80)</strong>, in the variable selection
dialog, shown in Figure <a href="#fig:bivlisavars">2</a>. Since the variables are time enabled, the proper period is selected by means of the <strong>Time</strong> drop down list. Also note that the spatial weights
matrix has been set to <strong>natregimes_q</strong>.</p>
<div class="figure" style="text-align: center"><span id="fig:bivlisavars"></span>
<img src="pics6c/1_bivloc_vars.png" alt="Bivariate Local Moran variable selection" width="35%" />
<p class="caption">
Figure 2: Bivariate Local Moran variable selection
</p>
</div>
<p>The next prompt gives the familiar choice of a <strong>Significance Map</strong>, <strong>Cluster Map</strong>,
and <strong>Moran Scatter Plot</strong>, with just the <strong>Cluster Map</strong> selected as the default. With the default setting, the result is based on 999 permutations with a p-value of 0.05, as shown in Figure <a href="#fig:bivlisacluster">3</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:bivlisacluster"></span>
<img src="pics6c/1_bilisa_map.png" alt="Bivariate Local Moran cluster map" width="60%" />
<p class="caption">
Figure 3: Bivariate Local Moran cluster map
</p>
</div>
<p>All the options for randomization, significance filter, and saving the results are the same as for the univariate Local Moran and will not be further discussed here.</p>
</div>
<div id="interpretation" class="section level3 unnumbered" number="">
<h3>Interpretation</h3>
<p>As mentioned, the interpretation of the bivariate Local Moran cluster map warrants some caution, since it does not control for the correlation between the two variables at each location (i.e., the correlation between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span>). To illustrate this issue, consider the space-time case, where one can interpret the results of the High-High and Low-Low clusters in Figure <a href="#fig:bivlisacluster">3</a> as locations where high/low values at time <span class="math inline">\(t\)</span> (in our example, homicide rates in 1990) were surrounded by high/low values at time <span class="math inline">\(t -1\)</span> (homicide rates in 1980) more so than would be the case randomly. This could either be attributed to the surrounding locations in the past affecting the central location at the current time (a form of a diffusion effect), but could also be due to a strong inertia, in which case there would be no diffusion. More precisely, if the homicide rates in all locations are highly correlated over time, then if the surrounding values in <span class="math inline">\(t - 1\)</span> were correlated with the value at <span class="math inline">\(i\)</span> in <span class="math inline">\(t - 1\)</span>, then they would also tend to be correlated with the value at <span class="math inline">\(i\)</span> in <span class="math inline">\(t\)</span> (through the correlation between <span class="math inline">\(y_{j,t-1}\)</span> and <span class="math inline">\(y_{j,t}\)</span>). Hence, while these findings <em>could</em> be compatible with diffusion, this is not necessarily the case. The same complication affects the interpretation of the bivariate Local Moran coefficient between two variables at the same point in time.</p>
<p>To illustrate the problems with interpreting bivariate local cluster maps, we take the case of spatial outliers. In addition to the bivariate results, we also consider the univariate Local
Moran cluster maps for the variable in each time period, i.e., in <span class="math inline">\(t - 1\)</span>
and in <span class="math inline">\(t\)</span>, i.e., <strong>hr(80)</strong> and <strong>hr(90)</strong>, as shown in Figures <a href="#fig:bivspacetime">4</a> and <a href="#fig:localhr90">5</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:bivspacetime"></span>
<img src="pics6c/1_bivspacetime.png" alt="Local Moran cluster map -- hr80" width="60%" />
<p class="caption">
Figure 4: Local Moran cluster map – hr80
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:localhr90"></span>
<img src="pics6c/1_hr90.png" alt="Local Moran cluster map -- hr90" width="60%" />
<p class="caption">
Figure 5: Local Moran cluster map – hr90
</p>
</div>
<p>The highlighted county is Inyo county (CA), which is identified as a Low-High spatial outlier in Figure <a href="#fig:bivlisacluster">3</a>. In 1980, this county was part of a High-High cluster, whereas in 1990, it was not significant. In this instance, we can interpret the spatial outlier in the space-time cluster map as indicating a
(relative) decrease in the homicide rate for that county in 1990 relative to 1980, when it was surrounded by high homicide rate counties. However, what we cannot conclude is that the surrounding counties still have high homicide rates in 1990. In fact, the pattern is
insufficient to be considered significant.</p>
</div>
</div>
<div id="multivariate-local-geary" class="section level2 unnumbered" number="">
<h2>Multivariate Local Geary</h2>
<div id="principle-1" class="section level3 unnumbered" number="">
<h3>Principle</h3>
<p>In <span class="citation">Anselin (<a href="#ref-Anselin:18" role="doc-biblioref">2019</a>)</span>, a multivariate extension of the Local Geary statistic is proposed. This statistic measures the extent to which neighbors in multiattribute space (i.e., data points that are close together in the multidimensional variable space) are also neighbors in geographical space. While the mathematical formalism is easily extended to many variables, in practice one quickly runs into the <em>curse of dimensionality</em>.</p>
<p>In essence, the Multivariate Local Geary statistic measures the extent to which the average distance in attribute space between the values at a location and the values at its neighboring locations are smaller or larger than what they would be under spatial randomness. The former case corresponds to positive spatial autocorrelation, the latter to negative spatial autocorrelation.</p>
<p>An important aspect of the multivariate statistic is that it is not simply the superposition of univariate statistics. In other words, even though a location may be identified as a cluster using the univariate Local Geary for each of the variables separately, this does not mean that it is also a multivariate cluster. The univariate statistics deal with distances in attribute space projected onto a single dimension, whereas the multivariate statistics are based on distances in a higher dimensional space. The multivariate statistic thus provides an additional perspective to measuring the tension between attribute similarity and locational similarity.</p>
<p>The Multivariate Local Geary statistic is formally the sum of individual Local Geary statistics for each of the variables under consideration. For example, with <span class="math inline">\(k\)</span> variables, indexed by <span class="math inline">\(h\)</span>, the corresponding expression is:
<span class="math display">\[c_i^M = \sum_{h=1}^k \sum_j w_{ij} (x_{hi} - x_{hj})^2.\]</span>
This measure corresponds to a weighted average of the squared distances in multidimensional attribute space between the values observed at a given geographic location <span class="math inline">\(i\)</span> and those at its geographic neighbors <span class="math inline">\(j \in N_i\)</span> (with <span class="math inline">\(N_i\)</span> as
the neighborhood set of <span class="math inline">\(i\)</span>).</p>
<p>To achieve comparable values for the statistics, one can correct for the number of variables involved, as <span class="math inline">\(c_i^M / k\)</span>. This is the approach taken in <code>GeoDa</code>.</p>
<p>Inference can again be based on a conditional permutation approach. This consists of holding the <em>tuple</em> of values observed at <span class="math inline">\(i\)</span> fixed, and computing the statistic for a number of permutations of the remaining tuples over the other locations. Note that because the full tuple is being used in the permutation, the internal correlation of the variables is controlled for, and only the <em>spatial</em> component gets altered.</p>
<p>The permutation results in an empirical reference distribution that represents a computational approach at obtaining the distribution of the statistic under the null. The associated pseudo p-value corresponds to the fraction of statistics in the empirical reference distribution that are equal to or more extreme than the observed statistic.</p>
<p>Such an approach suffers from the same problem of multiple comparisons mentioned for all the other local statistics. In addition, there is a further complication. When comparing the results for <span class="math inline">\(k\)</span> univariate Local Geary statistics, these multiple comparisons need to be accounted for as well.</p>
<p>For example, for each univariate test, the target p-value of <span class="math inline">\(\alpha\)</span> would typically be adjusted to <span class="math inline">\(\alpha / k\)</span> (with <span class="math inline">\(k\)</span> variables, each with a univariate test), as a Bonferroni bound. Since the multivariate statistic is in essence a sum of the statistics for the univariate cases, this would suggest a similar approach by dividing the target p-value by the number of variables (<span class="math inline">\(k\)</span>). Alternatively, and preferable, a FDR strategy can be pursued. The extent to which this actually compensates for the two dimensions of multiple comparison (multiple variables and multiple observations) remains to be further investigated.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
</div>
<div id="implementation-1" class="section level3 unnumbered" number="">
<h3>Implementation</h3>
<div id="univariate-analysis-of-multiple-variables" class="section level4 unnumbered" number="">
<h4>Univariate analysis of multiple variables</h4>
<p>Before moving on to the multivariate case, we consider what we learn from a univariate analysis
of multiple variables. We will use the <strong>Geary</strong> data set and the variables crimes against persons
(<strong>Crm_prs</strong>), crimes against property (<strong>Crm_prp</strong>), and donations (<strong>Donatns</strong>).</p>
<p>We first gain a general perspective on the spatial distribution of each variable by means of a set of
quintile maps, shown in Figures <a href="#fig:quintpers">6</a> to <a href="#fig:quintdon">8</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:quintpers"></span>
<img src="pics6c/11_quint_crimpers.png" alt="Quintile map - Crime against persons" width="60%" />
<p class="caption">
Figure 6: Quintile map - Crime against persons
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:quintprop"></span>
<img src="pics6c/11_quint_crimprop.png" alt="Quintile map - Crime against property" width="60%" />
<p class="caption">
Figure 7: Quintile map - Crime against property
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:quintdon"></span>
<img src="pics6c/11_quint_donat.png" alt="Quintile map - Donations" width="60%" />
<p class="caption">
Figure 8: Quintile map - Donations
</p>
</div>
<p>These maps illustrate the challenge encountered when trying to quantify multivariate spatial correlation, in that they bring out very different patterns.
For example, as we may recall from previous Chapters, we notice the concentration of lowest quintile values in the
south-east of the country for <strong>Donatns</strong> (in Figure <a href="#fig:quintdon">8</a>), that is somewhat matched by
a similar pattern for <strong>Crm_prs</strong> (in Figure <a href="#fig:quintpers">6</a>). However, for <strong>Crm_prp</strong>, the opposite seems
to be the case (Figure <a href="#fig:quintprop">7</a>). The lack of correspondence is also indicated by a fairly weak
pairwise correlation between these variables: 0.255 between <strong>Crm_prs</strong> and <strong>Crm_prp</strong>, 0.134 between
<strong>Crm_prs</strong> and <strong>Donatns</strong>, and -0.082 between <strong>Crm_prp</strong> and <strong>Donatns</strong> <span class="citation">(see Anselin <a href="#ref-Anselin:18" role="doc-biblioref">2019</a>, 141)</span>.</p>
<p>We further summarize the patterns by means of a Local Geary cluster map for each individual variable,
shown in Figures <a href="#fig:lgpers">9</a> to <a href="#fig:lgdon">11</a>. This confirms the lack of match between the
individual spatial distributions (for queen contiguity, with 999 permutations and p=0.05). We find
confirmation of the strong Low-Low cluster in the south-east for <strong>Crm_prs</strong> and <strong>Donatns</strong>, but for
<strong>Crm_prp</strong>, there seems to be a small Low-Low cluster in the north. Also note several instances of
spatial outliers, as well as one example where positive spatial autocorrelation could not be classified
for <strong>Crm_prp</strong> (i.e., <em>Other Positive</em>, in Figure <a href="#fig:lgprop">10</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:lgpers"></span>
<img src="pics6c/11_locg_crimpers.png" alt="Local Geary cluster map - Crime against persons" width="60%" />
<p class="caption">
Figure 9: Local Geary cluster map - Crime against persons
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:lgprop"></span>
<img src="pics6c/11_locg_crimprop.png" alt="Local Geary cluster map - Crime against property" width="60%" />
<p class="caption">
Figure 10: Local Geary cluster map - Crime against property
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:lgdon"></span>
<img src="pics6c/11_localg_donat.png" alt="Local Geary cluster map - Donations" width="60%" />
<p class="caption">
Figure 11: Local Geary cluster map - Donations
</p>
</div>
<p>A final summary is provided by the co-location map in Figure <a href="#fig:lgcoloc">12</a>.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> This shows the degree of overlap
(or, rather, lack thereof) between the significant locations (at p=0.05) for each of the three Local Geary analyses.
Only one observation is significant for all three variables, but it is a spatial outlier for <strong>Crm_prs</strong> and
<strong>Crm_prp</strong> and part of a High-High cluster for <strong>Donatns</strong>, suggesting conflicting patterns.
The map also shows that 39 observations are not significant for all three variables (0 in the legend), whereas
45 indicate a conflict (significant for one or two, but not three of the variables).</p>
<div class="figure" style="text-align: center"><span id="fig:lgcoloc"></span>
<img src="pics6c/11_localg_colocsig.png" alt="Colocation map - significant locations" width="60%" />
<p class="caption">
Figure 12: Colocation map - significant locations
</p>
</div>
<p>In sum, this example highlights the complexity of trying to draw a conclusion about a multivariate
spatial correlation pattern from the univariate analysis of the constituent variables.</p>
</div>
<div id="multivariate-analysis" class="section level4 unnumbered" number="">
<h4>Multivariate analysis</h4>
<p>The Multivariate Local Geary functionality is invoked from the fourth group in the <strong>Cluster Maps</strong> toolbar icon
drop down list (see Figure <a href="#fig:bivariatelisa">1</a>), or from the menu as <strong>Space &gt; Multivariate Local Geary</strong>.</p>
<p>The variable selection dialog allows for multiple variables to be chosen. In our example, we continue
with <strong>Crm_prs</strong>, <strong>Crm_prp</strong> and <strong>Donatns</strong>, with the spatial weights set to <strong>guerry_85_q</strong>, as in Figure <a href="#fig:multigearyvars">13</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:multigearyvars"></span>
<img src="pics6c/11_multigeary_vars.png" alt="Multivariate local Geary variable selection" width="25%" />
<p class="caption">
Figure 13: Multivariate local Geary variable selection
</p>
</div>
<p>As before, a dialog offers the option of a significance map and a cluster map, with the latter as the default. To illustrate the two types of results, we check both options.</p>
<p>With all the other options set to their defaults (999 permutations, p = 0.05), this yields the significance and
cluster maps shown in Figure <a href="#fig:multigearymap">14</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:multigearymap"></span>
<img src="pics6c/11_multi_geary.png" alt="Multivariate local Geary significance and cluster map" width="80%" />
<p class="caption">
Figure 14: Multivariate local Geary significance and cluster map
</p>
</div>
<p>Note that for this p-value, we obtain 37 positive clusters, but the single location we identified in
Figure <a href="#fig:lgcoloc">12</a> is not one of them. The location of the observations with the highest significance
in the south-east suggests that the similarity between <strong>Crm_prs</strong> and <strong>Donatns</strong> may overwhelm the effect
of the third variable. Since the Multivariate Local Geary is a sum of the individual Local Geary, two very small (positive
spatial autocorrelation) squared distances may compensate for a larger third one and yield significance in a
multivariate world.</p>
<p>All the usual options regarding the number of permutations, the significance filter, and saving the results hold as for any other local spatial statistic in <code>GeoDa</code>. While we do not pursue this further here, it should be noted that a sensitivity analysis with respect to different significance levels is highly recommended.</p>
</div>
</div>
<div id="interpretation-1" class="section level3 unnumbered" number="">
<h3>Interpretation</h3>
<p>The results of the Multivariate Local Geary significance or cluster map are not always easy to interpret. Mainly, this is because we tend to simply superimpose the results of the univariate tests, whereas the multivariate statistic involves different tradeoffs.</p>
<p>As mentioned, the problem of multiple comparisons means that the use of the default p-value of 0.05 is almost certainly misleading. A useful alternative is to use the False Discovery Rate, although this only works in small to medium
sized data set, due to the maximum on the number permutations in the current implementation of <code>GeoDa</code>. In our
example, a p-value of 0.01 also corresponds roughly to the FDR. We illustrate the effect of tightening the p-value in
Figure <a href="#fig:multigearyfdr">15</a> (we increased the number of permuations to 99,999, but no observations were
significant at p &lt; 0.001). The number of <em>significant</em> locations in cut in half and reduced to 18. The strongest
cluster is found in the south-east.</p>
<div class="figure" style="text-align: center"><span id="fig:multigearyfdr"></span>
<img src="pics6c/11_multig_sig01.png" alt="Multivariate local Geary significance map - p = 0.01" width="60%" />
<p class="caption">
Figure 15: Multivariate local Geary significance map - p = 0.01
</p>
</div>
<div id="multivariate-clusters-and-3d-scatter-plot" class="section level4 unnumbered" number="">
<h4>Multivariate clusters and 3D scatter plot</h4>
<p>In order to illustrate the complexity of the multivariate case, Figure <a href="#fig:3ddistance">16</a> shows three neighboring
highly significant locations in the cluster selected in both the significance map and a 3D data cube. The links to the neighbors are also highlighted.
This shows that even though the observations in question are very close in multi-attribute space, some of their
neighbors are much further removed. This highlights the tradeoffs involved in the averaging of the individual
squared distances from the Local Geary statistics. This is not always intuitive. With three variables, this can
be visualized in a 3D data cube, but with more variables, this is much harder.</p>
<div class="figure" style="text-align: center"><span id="fig:3ddistance"></span>
<img src="pics6c/11_3d_distance.png" alt="Multivariate local cluster in 3D data cube" width="80%" />
<p class="caption">
Figure 16: Multivariate local cluster in 3D data cube
</p>
</div>
</div>
<div id="multivariate-clusters-and-pcp" class="section level4 unnumbered" number="">
<h4>Multivariate clusters and PCP</h4>
<p>We pursue this further with an example that uses six variables: <strong>Crm_prs</strong>, <strong>Crm_prp</strong>, <strong>Litercy</strong>,
<strong>Donatns</strong>, <strong>Infants</strong> and <strong>Suicids</strong>, again with queen contiguity. The significance map, for 99,999 permutations
and with p=0.01 is shown in the left panel of Figure <a href="#fig:multipcp1">17</a>. Two highly significant locations are
selected and their corresponding paths in a parallel coordinate plot highlighted in the right panel. In this
example, the neighbors track each other almost perfectly on all six dimensions.</p>
<div class="figure" style="text-align: center"><span id="fig:multipcp1"></span>
<img src="pics6c/11_multig_six_pcp1.png" alt="Multivariate local cluster and PCP (1)" width="80%" />
<p class="caption">
Figure 17: Multivariate local cluster and PCP (1)
</p>
</div>
<p>Figure <a href="#fig:multipcp2">18</a> shows an example where the intuition is much less clear. Two other highly significant
neighboring locations are selected in the left-hand panel, and their corresponding paths shown on the right.
In this instance, while the distances between the paths are small, there is much less of a close match.</p>
<div class="figure" style="text-align: center"><span id="fig:multipcp2"></span>
<img src="pics6c/11_multig_six_pcp2.png" alt="Multivariate local cluster and PCP (2)" width="80%" />
<p class="caption">
Figure 18: Multivariate local cluster and PCP (2)
</p>
</div>
<p>Nevertheless, this illustrates how a judicious use of multiple graphs and maps can create insight
into the complex tradeoffs between attribute similarity in a higher dimension for neighboring locations.</p>
</div>
</div>
</div>
<div id="local-neighbor-match-test" class="section level2 unnumbered" number="">
<h2>Local Neighbor Match Test</h2>
<div id="principle-2" class="section level3 unnumbered" number="">
<h3>Principle</h3>
<p>An alternative approach to visualize and quantify the tradeoff between geographical and attribute
similarity was suggested by <span class="citation">Anselin and Li (<a href="#ref-AnselinLi:20" role="doc-biblioref">2020</a>)</span> in the form of what is called a <em>local neighbor match test</em>.
The basic idea is to assess the extent of overlap between k-nearest neighbors in geographical space
and k-nearest neighbors in multi-attribute space.</p>
<p>In <code>GeoDa</code>, this is a simple intersection operation between two k-nearest neighbor weights matrices,
one computed for the variables (standardized) and one using geographical distance. We can then
quantify the probability that an overlap occurs between the two neighbor sets. This corresponds to the probability
of drawing <span class="math inline">\(v\)</span> common neighbors from the <span class="math inline">\(k\)</span> out of <span class="math inline">\(n - 1 - k\)</span> possible choices as neighbors,
a straightforward combinatorial calculation.</p>
<p>More formally, the probability of <span class="math inline">\(v\)</span> shared neighbors out of <span class="math inline">\(k\)</span> is:
<span class="math display">\[p = C(k,v).C(N-k,k-v) / C(N,k),\]</span>
where <span class="math inline">\(N = n - 1\)</span> (one less than the number of observations), <span class="math inline">\(k\)</span> is the number of nearest neighbors considered
in the connectivity graphs, <span class="math inline">\(v\)</span> is the number of neighbors in common, and <span class="math inline">\(C\)</span> is the combinatorial operator.
Alternatively, a pseudo p-value can be computed based on a permutation approach, although that is not
pursued in <code>GeoDa</code>.</p>
<p>The degree of overlap can be visualized by means of a cardinality map (a special case of a unique values map),
where each location indicates how many neighbors the two weights matrices have in common. In addition, different
p-value cut-offs can be employed to select the <em>significant</em> locations, i.e., where the probability of a given
number of common neighbors falls below the chosen p.</p>
<p>In practice, the value of <span class="math inline">\(k\)</span> may need to be adjusted (increased) in order to find meaningful results. In addition,
the k-nearest neighbor calculation becomes increasingly difficult to implement in very high attribute dimensions,
due to the empty space problem.</p>
<p>The idea of matching neighbors can be extended to distances among variables obtained from dimension reduction techniques, such as
multidimensional scaling, covered in a later Chapter <span class="citation">(see also the more detailed discussion in Anselin and Li <a href="#ref-AnselinLi:20" role="doc-biblioref">2020</a>)</span>.</p>
<p>In contrast to the approach taken for the Multivariate Local Geary, the local neighbor match test focuses
on the distances directly, rather than converting them into a weighted average. Both measures have in common
that they focus on squared distances in attribute space, rather than a cross-product as in the Moran
statistics.</p>
</div>
<div id="implementation-2" class="section level3 unnumbered" number="">
<h3>Implementation</h3>
<p>We illustrate the local neighbor match test by means of the <strong>Guerry</strong> data set. We use the same six
variables as before: <strong>Crm_prs</strong>, <strong>Crm_prp</strong>, <strong>Litercy</strong>,
<strong>Donatns</strong>, <strong>Infants</strong> and <strong>Suicids</strong>. We first illustrate the logic behind the method and then show
its implementation in <code>GeoDa</code>.</p>
<p>We start by creating two k-nearest neighbor weights matrices for k=6, one based on Euclidean geographical
distance, the other on multi-variable distance using the six specified variables in z-standardized form.
Both matrices should be contained in the <strong>Weights Manager</strong>.</p>
<div id="intersection-between-connectivity-graphs" class="section level4 unnumbered" number="">
<h4>Intersection between connectivity graphs</h4>
<p>We compare the connectivity graphs for the geographical (<strong>guerry_85_kd6</strong>) and the multi-variable
(<strong>guerry_85_k6v</strong>) weights. They are shown side-by-side in Figure <a href="#fig:connintersection">19</a>, with the geographical
connectivity on the left. Whereas the latter has the familiar form, the multi-variable connectivity is quite
complex and shows connections between locations that are far apart in geographical space.</p>
<div class="figure" style="text-align: center"><span id="fig:connintersection"></span>
<img src="pics6c/11_multi_k_conn.png" alt="Connectivity graph for distance k=6 and multivariable k=6" width="80%" />
<p class="caption">
Figure 19: Connectivity graph for distance k=6 and multivariable k=6
</p>
</div>
<p>In the <strong>Weights Manager</strong>, we select the <strong>Intersection</strong> button for these two weights to create a new
<strong>gal</strong> file. The connectivity graph for the common neighbors is shown in Figure <a href="#fig:connintersection1">20</a>.
This illustrates the logic underlying the local neigbhor match test. What remains to be done is to assess the
extent to which the number of coincident neighbors is due to chance, or unlikely under random matching.</p>
<div class="figure" style="text-align: center"><span id="fig:connintersection1"></span>
<img src="pics6c/11_multi_k_intersection.png" alt="Intersection between connectivity graphs" width="60%" />
<p class="caption">
Figure 20: Intersection between connectivity graphs
</p>
</div>
</div>
<div id="testing-the-local-neighbor-match" class="section level4 unnumbered" number="">
<h4>Testing the local neighbor match</h4>
<p>We invoke the local neighbor match test as the last item in the <strong>Cluster Maps</strong> toolbar icon, as show
in Figure <a href="#fig:bivariatelisa">1</a>,
or from the menu as <strong>Space &gt; Local Neighbor Match Test</strong>. Next follows a query for the variables, in
the usual dialog, shown in Figure <a href="#fig:matchvars">21</a>. We select the same six variables as before.
In addition, we set the <strong>Number of Neighbors</strong> to 6, and use <strong>Euclidean Distance</strong> for both neighbor criteria.
Finally, we also make sure that the variables are used in <strong>standardized</strong> form.</p>
<div class="figure" style="text-align: center"><span id="fig:matchvars"></span>
<img src="pics6c/22_localmatch_dialog.png" alt="Local neighbor match variable selection" width="30%" />
<p class="caption">
Figure 21: Local neighbor match variable selection
</p>
</div>
<p>After starting the procedure, a simple dialog in Figure <a href="#fig:matchsavevars">22</a> appears, in order to specify whether to save the common neighbor cardinality
and associated p-value in the table. This must be done in order to refer back to the probability for later visualization.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsavevars"></span>
<img src="pics6c/11_match_save.png" alt="Local neighbor match save results" width="20%" />
<p class="caption">
Figure 22: Local neighbor match save results
</p>
</div>
<p>The result of the analysis is a special unique values map that shows the cardinality (the number) of common neighbors
for each location, as well as the corresponding links from the connectivity graph, as in Figure <a href="#fig:matchsconngraph">23</a>.
This is essentially the same graph as in Figure <a href="#fig:connintersection1">20</a>, but with the cardinality added as a
shade (darker shade for more neighbors). The commonality ranges from 1 location with 5 neighbors, and 4 with 4, to 25 with one neighbor.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsconngraph"></span>
<img src="pics6c/11_local_match_conn.png" alt="Local neighbor match connectivity cardinality" width="60%" />
<p class="caption">
Figure 23: Local neighbor match connectivity cardinality
</p>
</div>
<p>In addition, the cardinality and associated probability are added to the data table, as in Figure <a href="#fig:matchintable">24</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:matchintable"></span>
<img src="pics6c/11_match_in_table.png" alt="Local neighbor match cardinality and p-value" width="30%" />
<p class="caption">
Figure 24: Local neighbor match cardinality and p-value
</p>
</div>
</div>
<div id="significance" class="section level4 unnumbered" number="">
<h4>Significance</h4>
<p>As such, the neighbor cardinality map does not indicate any significance. It is clear that having 5 neighbors out of 6 is fairly rare (in fact, its probability is 0.000001), but it is not clear where to draw the line between significant and not. We can now use the <strong>Selection Tool</strong>
in the table to select all observations with a p-value of less than 0.05 (or any other relevant value). This
results in the significant locations being highlighted in the cardinality map, as in Figure <a href="#fig:matchsconnsig">25</a>.
It turns out that for this cut-off, there are 21 significant observations, all with 3 or more neighbors in common.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsconnsig"></span>
<img src="pics6c/11_localmatch_sig.png" alt="Local neighbor match significant locations (p=0.05)" width="60%" />
<p class="caption">
Figure 25: Local neighbor match significant locations (p=0.05)
</p>
</div>
<p>We can further decompose the connectivity structure for the significant locations by highlighting them in both
original connectivity graphs, as in Figure <a href="#fig:matchsconnboth">26</a>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> In the subset of significant locations in
the south-west corner of the country, we notice a remarkable match between the two connectivity structures. In contrast,
some of the significant locations in the north have multi-attribute connections with locations that are geographically
far removed.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsconnboth"></span>
<img src="pics6c/11_match_sig_inconn.png" alt="Local neighbor match significant locations in connectivity graphs" width="80%" />
<p class="caption">
Figure 26: Local neighbor match significant locations in connectivity graphs
</p>
</div>
</div>
<div id="local-neighbor-match-and-multivariate-local-geary" class="section level4 unnumbered" number="">
<h4>Local neighbor match and Multivariate Local Geary</h4>
<p>To close, we compare the most significant locations identified by the Multivariate Local Geary and the local neighbor
match test. We used 99,999 permutations and a p-value of 0.01 for the Local Geary cluster map.</p>
<p>In Figure <a href="#fig:matchsmultig1">27</a> we select the most significant location in the local neighbor match test map on
the left. Its 5 neighbors
that are common on the two criteria are highlighted as well. In the cluster map on the left, we
find the corresponding location and its neighbors. As it turns out, the central location (department of Tarn) is identified
as having a p-value of 0.0001 in the cluster map. One of its neighbors achieves the same value, while two have p=0.001,
and on p = 0.01. However, one of the common neighbors is not significant according to the Multivariate Local Geary.
Nevertheless, the match between the two approaches is striking, confirming that both use a similar perspective.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsmultig1"></span>
<img src="pics6c/11_match_multigeary.png" alt="Local neighbor match significant locations and Multivariate Local Geary (1)" width="80%" />
<p class="caption">
Figure 27: Local neighbor match significant locations and Multivariate Local Geary (1)
</p>
</div>
<p>In Figure <a href="#fig:matchsmultig2">28</a>, we take the opposite approach. We select the 11 locations in the right-hand map that
are significant at p=0.0001. The left-hand panel shows the matching selection in the local neighbor match test. In addition to the Tarn department with 5 matches, we also find three of the four departments with 4 matches to be identified in both maps. In all, of the 11 significant Local Geary locations, 9 are significant at p=0.05 in the local neigbhor match map. Interestingly, two significant Local Geary locations (Basses-Alpes and Ariege) only have two common neighbors.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsmultig2"></span>
<img src="pics6c/11_match_multigeary1.png" alt="Local neighbor match significant locations and Multivariate Local Geary (2)" width="80%" />
<p class="caption">
Figure 28: Local neighbor match significant locations and Multivariate Local Geary (2)
</p>
</div>
<p>We investigate the connectivity pattern for those two locations more closely in Figure <a href="#fig:matchsmultig3">29</a>.
In the right-hand panel, we see how the multi-attribute neighbors for both departments tend to be far removed
geographically. In the averaging operation that is behind the Multivariate Local Geary, the difference with the
contiguous locations are averaged out. In the local neighbor match test, the focus is singularly on the distances
themselves.</p>
<div class="figure" style="text-align: center"><span id="fig:matchsmultig3"></span>
<img src="pics6c/11_geary_match_2.png" alt="Significant Multivariate Local Geary locations with only two matching neighbors" width="80%" />
<p class="caption">
Figure 29: Significant Multivariate Local Geary locations with only two matching neighbors
</p>
</div>
<p>In spite of these slight discrepancies between the two methods, they tend to identify the same broad clusters.
Given that it has fewer issues with determining the proper p-value, the local neighbor match test thus provides
a viable alternative to detect multivariate spatial clusters.</p>
<p><br></p>
</div>
</div>
</div>
<div id="references" class="section level2 unnumbered" number="">
<h2>References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-Anselin:18">
<p>Anselin, Luc. 2019. “A Local Indicator of Multivariate Spatial Association, Extending Geary’s c.” <em>Geographical Analysis</em> 51 (2): 133–50.</p>
</div>
<div id="ref-AnselinLi:20">
<p>Anselin, Luc, and Xun Li. 2020. “Tobler’s Law in a Multivariate World.” <em>Geographical Analysis</em> 52 (4): 494–510. <a href="https://doi.org/10.111/gean.12237">https://doi.org/10.111/gean.12237</a>.</p>
</div>
<div id="ref-Anselinetal:02b">
<p>Anselin, Luc, Ibnu Syabri, and Oleg Smirnov. 2002. “Visualizing Multivariate Spatial Correlation with Dynamically Linked Windows.” In <em>New Tools for Spatial Data Analysis: Proceedings of the Specialist Meeting</em>, edited by Luc Anselin and Sergio Rey. University of California, Santa Barbara: Center for Spatially Integrated Social Science (CSISS).</p>
</div>
<div id="ref-Drayetal:08">
<p>Dray, Stéphane, Sonia Saïd, and François Débias. 2008. “Spatial Ordination of Vegetation Data Using a Generalization of Wartenberg’s Multivariate Spatial Correlation.” <em>Journal of Vegetation Science</em> 19: 45–56.</p>
</div>
<div id="ref-Fotheringhametal:02">
<p>Fotheringham, A. Stewart, Chris Brunsdon, and Martin Charlton. 2002. <em>Geographically Weighted Regression</em>. Chichester: John Wiley.</p>
</div>
<div id="ref-LeeS:01">
<p>Lee, Sang-Il. 2001. “Developing a Bivariate Spatial Association Measure: An Integration of Pearson’s r and Moran’s I.” <em>Journal of Geographical Systems</em> 3: 369–85.</p>
</div>
<div id="ref-Lin:20">
<p>Lin, Jie. 2020. “A Local Model for Multivariate Analysis: Extending Wartenberg’s Multivariate Spatial Correlation.” <em>Geographical Analysis</em> 52 (2): 190–210.</p>
</div>
<div id="ref-Wartenberg:85">
<p>Wartenberg, Daniel. 1985. “Multivariate Spatial Correlation: A Method for Exploratory Geographical Analysis.” <em>Geographical Analysis</em> 17: 263–83.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>University of Chicago, Center for Spatial Data Science – <a href="mailto:anselin@uchicago.edu" class="email">anselin@uchicago.edu</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>See <span class="citation">Anselin (<a href="#ref-Anselin:18" role="doc-biblioref">2019</a>)</span> for further technical discussion.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This map is
constructed by first turning the significant locations in each significance map into an indicator variable
for the <em>selection</em> (<strong>Save Selection</strong>), and then using these three variables in a co-location map.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The fill color of selected has been
changed to orange to bring the selected locations out more clearly.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<footer class="site-footer">
  <span class="site-footer-owner"><a href="https://github.com/lixun910/geoda">GeoDa</a> is maintained by <a href="#">lixun910</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
</footer>

</section>


<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
