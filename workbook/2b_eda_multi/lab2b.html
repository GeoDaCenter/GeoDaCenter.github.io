<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="author" content="Luc Anselin" />


  <title>Exploratory Data Analysis (2)</title>

  <script src="lab2b_files/header-attrs-2.3/header-attrs.js"></script>
  <link href="lab2b_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
  <script src="lab2b_files/highlightjs-9.12.0/highlight.js"></script>
  <title>GeoDa on Github</title>

  <style>
    * {
      margin: 0;
      padding: 0;
    }

    .shadowfilter {
      -webkit-filter: drop-shadow(12px 12px 7px rgba(0, 0, 0, 0.5));
      filter: url(shadow.svg#drop-shadow);
    }

    .intro1 {
      margin-left: -45px;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/normalize.css" media="screen">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/github-light.css"
    media="screen">
  <link rel="stylesheet" href="https://geodacenter.github.io/stylesheets/simple-slideshow-styles.css">
  <style>
    ul {
      padding-left: 30px;
    }

    figcaption {
      top: .70em;
      left: .35em;
      bottom: auto !important;
      right: auto !important;
    }
  </style>

  <style>
    h1 {
      text-align: center;
    }

    h3.subtitle {
      text-align: center;
    }

    h4.author {
      text-align: center;
    }

    h4.date {
      text-align: center;
    }

    p.caption {
      font-size: 12px;
    }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LC0QJ53WFS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-LC0QJ53WFS');
  </script>
  <!-- End Google tag -->

  <style type="text/css">
    code {
      white-space: pre;
    }
  </style>
  <script type="text/javascript">
    if (window.hljs) {
      hljs.configure({ languages: [] });
      hljs.initHighlightingOnLoad();
      if (document.readyState && document.readyState === "complete") {
        window.setTimeout(function () { hljs.initHighlighting(); }, 0);
      }
    }
  </script>








</head>

<body>


  <section class="page-header">
    <h1 class="project-name">GeoDa</h1>
    <h2 class="project-tagline">An Introduction to Spatial Data Science</h2>
    <a href="https://geodacenter.github.io/index.html" class="btn">Homepage</a>
    <a href="https://geodacenter.github.io/download.html" class="btn">Download</a>
    <a href="https://github.com/GeoDaCenter/geoda/" class="btn">View on GitHub</a>
    <a href="https://spatial.uchicago.edu/sample-data" target="_blank" class="btn">Data</a>
    <a href="https://geodacenter.github.io/documentation.html" class="btn">Documentation</a>
    <a href="https://geodacenter.github.io/support.html" class="btn">Support</a>
    <a href="https://geodacenter.github.io/index-cn.html" class="btn">中文</a>
  </section>

  <section class="main-content">


    <h1 class="title toc-ignore">Exploratory Data Analysis (2)</h1>
    <h3 class="subtitle">Multivariate Exploration</h3>
    <h4 class="author">Luc Anselin<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h4>
    <h4 class="date">09/29/2020 (updated)</h4>


    <div id="TOC">
      <ul>
        <li><a href="#introduction">Introduction</a>
          <ul>
            <li><a href="#objectives">Objectives</a>
              <ul>
                <li><a href="#geoda-functions-covered">GeoDa functions covered</a></li>
              </ul>
            </li>
            <li><a href="#preliminaries">Preliminaries</a></li>
          </ul>
        </li>
        <li><a href="#scatter-plot-matrix">Scatter Plot Matrix</a>
          <ul>
            <li><a href="#principle">Principle</a></li>
            <li><a href="#creating-a-scatter-plot-matrix">Creating a Scatter Plot Matrix</a>
              <ul>
                <li><a href="#scatter-plot-matrix-options">Scatter Plot Matrix options</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#three-variables-bubble-chart-and-3d-scatter-plot">Three Variables: Bubble Chart and 3D Scatter
            Plot</a>
          <ul>
            <li><a href="#bubble-chart">Bubble chart</a>
              <ul>
                <li><a href="#bubble-chart-options">Bubble chart options</a></li>
                <li><a href="#bubble-chart-using-categorical-variables">Bubble chart using categorical variables</a>
                </li>
              </ul>
            </li>
            <li><a href="#d-scatter-plot">3D Scatter Plot</a>
              <ul>
                <li><a href="#interacting-with-the-3d-scatter-plot">Interacting with the 3D scatter plot</a></li>
                <li><a href="#selection-in-the-3d-scatter-plot">Selection in the 3D scatter plot</a></li>
                <li><a href="#d-scatter-options">3D scatter options</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#true-multivariate-eda-parallel-coordinate-plot-and-conditional-plots">True Multivariate EDA:
            Parallel Coordinate Plot and Conditional Plots</a>
          <ul>
            <li><a href="#parallel-coordinate-plot-pcp">Parallel Coordinate Plot (PCP)</a>
              <ul>
                <li><a href="#principle-1">Principle</a></li>
                <li><a href="#creating-a-pcp">Creating a PCP</a></li>
                <li><a href="#clusters-and-outliers-in-pcp">Clusters and outliers in PCP</a></li>
                <li><a href="#multi-variable-pcp">Multi-variable PCP</a></li>
                <li><a href="#pcp-options">PCP options</a></li>
                <li><a href="#brushing-the-pcp">Brushing the PCP</a></li>
              </ul>
            </li>
            <li><a href="#conditional-plots">Conditional Plots</a>
              <ul>
                <li><a href="#principle-2">Principle</a></li>
                <li><a href="#creating-conditional-scatter-plots">Creating conditional scatter plots</a></li>
                <li><a href="#changing-the-conditioning">Changing the conditioning</a></li>
                <li><a href="#conditional-histogram">Conditional histogram</a></li>
                <li><a href="#conditional-box-plot">Conditional box plot</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
      </ul>
    </div>

    <p><br></p>
    <div id="introduction" class="section level2 unnumbered" number="">
      <h2>Introduction</h2>
      <p>In this Chapter, we continue to explore the EDA functionality in <code>GeoDa</code>, but now focus on methods
        to deal with multiple variables, such as the scatter plot matrix, bubble chart, 3D scatter plot, parallel
        coordinate plot and conditional plots.</p>
      <p>We will continue to use the by now familiar data set with demographic and socio-economic information for 55 New
        York City sub-boroughs.</p>
      <div id="objectives" class="section level3 unnumbered" number="">
        <h3>Objectives</h3>
        <ul>
          <li>
            <p>Interpreting a scatter plot matrix</p>
          </li>
          <li>
            <p>Interpreting bubble charts and 3D scatter plots</p>
          </li>
          <li>
            <p>Interpreting parallel coordinate plots</p>
          </li>
          <li>
            <p>Interpreting conditional plots</p>
          </li>
        </ul>
        <div id="geoda-functions-covered" class="section level4 unnumbered" number="">
          <h4>GeoDa functions covered</h4>
          <ul>
            <li>Explore &gt; Scatter Plot Matrix
              <ul>
                <li>changing the variable order in a scatter plot matrix</li>
                <li>smoothing and brushing the scatter plot matrix</li>
              </ul>
            </li>
            <li>Explore &gt; Bubble Chart
              <ul>
                <li>bubble chart classification schemes</li>
                <li>bubble size</li>
              </ul>
            </li>
            <li>Explore &gt; 3D Scatter Plot
              <ul>
                <li>rotating and zooming the 3D scatter plot</li>
                <li>projecting onto one axis</li>
                <li>selection in the 3D scatter plot</li>
              </ul>
            </li>
            <li>Explore &gt; Parallel Coordinate Plot
              <ul>
                <li>changing the classification theme for the PCP</li>
                <li>changing the order of the axes</li>
                <li>brushing the PCP</li>
              </ul>
            </li>
            <li>Explore &gt; Conditional Plot
              <ul>
                <li>conditional scatter plot</li>
                <li>conditional histogram</li>
                <li>conditional box plot</li>
                <li>conditional scatter plot option</li>
                <li>changing the condition breakpoints</li>
                <li>LOWESS smoother in conditional plots</li>
              </ul>
            </li>
          </ul>
          <p><br></p>
        </div>
      </div>
      <div id="preliminaries" class="section level3 unnumbered" number="">
        <h3>Preliminaries</h3>
        <p>We will continue to illustrate the various operations by means of the data set with demographic and
          socio-economic information for 55 New York City sub-boroughs that comes built-in with <code>GeoDa</code>. It
          is also
          contained in the <a href="https://geodacenter.github.io/data-and-lab/">GeoDa Center data set collection</a>.
        </p>
        <ul>
          <li><a href="https://geodacenter.github.io/data-and-lab/nyc/">nyc</a>: socio-economic data for 55 New York
            City sub-boroughs</li>
        </ul>
        <p><br></p>
        <p>As before, since the data set is built-in, there is no real need to download the sample data, although it is
          useful in order to preserve
          any changes.</p>
      </div>
    </div>
    <div id="scatter-plot-matrix" class="section level2 unnumbered" number="">
      <h2>Scatter Plot Matrix</h2>
      <div id="principle" class="section level3 unnumbered" number="">
        <h3>Principle</h3>
        <p>A scatter plot matrix visualizes the <em>bivariate relationships</em> among several pairs of variables. The
          individual scatter plots are stacked such that each variable is in turn on the x-axis and on
          the y-axis. When applied to standardized variables (with mean zero and
          variance one), it is the visual counterpart of a correlation matrix.</p>
        <p>In
          general, however, while the scatter plot matrix shows the linear association between
          variables, the graphs are not symmetric. The main interest is in the magnitude and sign of the slope in each
          of the scatter plots, and the extent to which this points to a significant bivariate relationship,
          similar to the insight provided by a correlation matrix.</p>
        <p>Even though this method is included in this Chapter, it is not really a <em>multivariate</em> exploration,
          but rather
          a collection of <em>bivariate</em> explorations for multiple variables.</p>
        <p>In <code>GeoDa</code>, the diagonal elements also contain a histogram for the variable in the corresponding
          row/column
          to provide a sense of the univariate distribution.</p>
      </div>
      <div id="creating-a-scatter-plot-matrix" class="section level3 unnumbered" number="">
        <h3>Creating a Scatter Plot Matrix</h3>
        <p>We start the scatter plot matrix by selecting the corresponding icon on the toolbar (part of the EDA icons),
          as in Figure <a href="#fig:scatmaticon">1</a>, or by choosing <strong>Explore &gt; Scatter Plot
            Matrix</strong> from the menu.</p>
        <div class="figure" style="text-align: center"><span id="fig:scatmaticon"></span>
          <img src="pics2b/7_scatmatrix_icon.png" alt="Scatter Plot Matrix toolbar icon" width="25%" />
          <p class="caption">
            Figure 1: Scatter Plot Matrix toolbar icon
          </p>
        </div>
        <p>This brings up a dialog through which variables can be added or removed, shown
          in Figure <a href="#fig:scatmatvars2">2</a>. The design of the interface is such that one selects a variable
          from the list on the left and clicks on the right arrow <strong>&gt;</strong> to include it in the list on the
          right (alternatively,
          one can double click on the variable name to move it to the right-hand column). The left arrow
          <strong>&lt;</strong> is there to remove a variable from the <strong>Include</strong> list.</p>
        <p>As soon as two variables are selected, the scatter plot matrix is rendered in the background. As new
          variables are added to the list on the right, the matrix in the background is updated with the additional
          scatter plots.</p>
        <p>In our example in Figure <a href="#fig:scatmatvars2">2</a>, we selected average people per household in 2000
          (<strong>hhsiz00</strong>), the percentage households with children under 18 in 2000
          (<strong>kids2000</strong>), the average number of years lived in the current residence in 2002
          (<strong>yrhom02</strong>), and the percentage households receiving public assistance in 2000
          (<strong>pubast00</strong>). The order of the variables can be changed by means of the <strong>Up</strong> and
          <strong>Down</strong> buttons in the dialog.</p>
        <div class="figure" style="text-align: center"><span id="fig:scatmatvars2"></span>
          <img src="pics2b/00_scat_matrix_vars.png" alt="Scatter Plot Matrix variables" width="50%" />
          <p class="caption">
            Figure 2: Scatter Plot Matrix variables
          </p>
        </div>
        <p>Once we move the dialog aside, the full 4 x 4 scatter plot matrix is revealed, as shown
          in Figure <a href="#fig:scatmat">3</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:scatmat"></span>
          <img src="pics2b/00_scat_matrix.png" alt="Scatter Plot Matrix" width="60%" />
          <p class="caption">
            Figure 3: Scatter Plot Matrix
          </p>
        </div>
        <p>The graph shows both positive and negative associations, as well as non-significant ones. Above
          each scatter plot, the slope of the linear fit is listed, with significance indicated by one * (p &lt; 0.05)
          or two ** (p &lt; 0.01).
          The histograms in the diagonal provide a sense of the shape of the univariate distribution for each variable.
        </p>
        <p>Among others, the graph reveals a strongly significant and positive relationship between the percentage
          households with kids and public assistance (as we saw before in the scatter plot), and a strong negative and
          significant relationship between number of years in the residence and public assistance. The relationship
          between years in residence and percent households with kids is not significant.</p>
        <div id="scatter-plot-matrix-options" class="section level4 unnumbered" number="">
          <h4>Scatter Plot Matrix options</h4>
          <p>As is customary, a right click (or control click) brings up the options for the scatter plot
            matrix, shown in Figure <a href="#fig:scatmatlowes1">4</a>. The defaults are a linear fit
            (<strong>Smoother &gt; Show Linear Smoother</strong>), with linking and brushing disabled (<strong>View &gt;
              Regimes Regression</strong>
            unchecked), and the slope values displayed. Selecting <strong>Add/Remove Variables</strong> bring back the
            variable selection dialog.</p>
          <p>Several of these options are familiar and have the same items as for the single scatter plot.
            This includes <strong>Selection Shape</strong>, <strong>Data</strong>, <strong>View</strong>, and
            <strong>Color</strong>. In addition, the scatter plot can also
            be saved as an image, in the usual fashion. We do not discuss these topics further here.</p>
          <p>Two options warrant some further attention.
            First, in addition to the linear fit, the scatter plot matrix also supports a LOWESS fit, with the same
            parameter editing capability as in the standard scatter plot. This is invoked by
            selecting <strong>Smoother &gt; Show LOWESS Smoother</strong>, as shown in Figure <a
              href="#fig:scatmatlowes1">4</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:scatmatlowes1"></span>
            <img src="pics2b/00_scatmat_options.png" alt="Scatter Plot Matrix smoothing options" width="30%" />
            <p class="caption">
              Figure 4: Scatter Plot Matrix smoothing options
            </p>
          </div>
          <p>A LOWESS smoother (with bandwidth 0.40) reveals considerable non-linearity in some of the bivariate
            relationships, as illustrated in Figure <a href="#fig:scatmatlowes2">5</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:scatmatlowes2"></span>
            <img src="pics2b/00_scatmat_lowess.png" alt="Scatter Plot Matrix with LOWESS smoothing" width="60%" />
            <p class="caption">
              Figure 5: Scatter Plot Matrix with LOWESS smoothing
            </p>
          </div>
          <p>Finally, with the brushing and linking functionality enabled (<strong>View &gt; Regimes Regression</strong>
            checked), potential structural breaks can be further investigated dynamically
            (for ease of viewing, the <strong>LOWESS Smoother</strong> option is turned off). As in the standard scatter
            plot, the red linear fit corresponds to the selected observations, the blue line is for the unselected ones
            and the purple line is for the complete sample. As evidenced in Figure <a href="#fig:scatmatregimes">6</a>,
            the selected observations are also highlighted in the histograms on the diagonal, as well as in any other
            open windows/graphs.</p>
          <div class="figure" style="text-align: center"><span id="fig:scatmatregimes"></span>
            <img src="pics2b/00_scatmat_regimes.png" alt="Scatter Plot Matrix with brushing" width="60%" />
            <p class="caption">
              Figure 6: Scatter Plot Matrix with brushing
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="three-variables-bubble-chart-and-3d-scatter-plot" class="section level2 unnumbered" number="">
      <h2>Three Variables: Bubble Chart and 3D Scatter Plot</h2>
      <p>Once we move beyond two variables, it becomes difficult to explicitly visualize the relationships among the
        variables in higher-dimensional space. Techniques to deal with such higher dimensions all boil down to reducing
        the dimensionality of the problem, i.e., attempting to show the relationships in a two-dimensional plane. In
        this section, we consider two of these techniques that work for situations in three dimensions (or, at most,
        four), the bubble chart and the 3-dimensional scatter plot.</p>
      <div id="bubble-chart" class="section level3 unnumbered" number="">
        <h3>Bubble chart</h3>
        <p>The bubble chart is an extension of the scatter plot to include a third and possibly a fourth variable into
          the two-dimensional chart. While the points in the two-dimensional scatter plot remain as showing the
          association between two variables, the size of the points (the <em>bubble</em>) is used to introduce a third
          variable. In addition, the color shading of the points can be used to consider a fourth variable as well,
          although this may stretch our perceptual abilities.</p>
        <p>The bubble chart is invoked from the menu as <strong>Explore &gt; Bubble Chart</strong>, and from the toolbar
          by selecting the fifth icon
          in the EDA group, shown in Figure <a href="#fig:bubbleicon">7</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:bubbleicon"></span>
          <img src="pics2b/8_193_bubbleicon.png" alt="Bubble Chart toolbar icon" width="25%" />
          <p class="caption">
            Figure 7: Bubble Chart toolbar icon
          </p>
        </div>
        <p>This brings up a dialog to select the variables for up to four dimensions: <strong>X-Axis</strong>,
          <strong>Y-Axis</strong>, <strong>Bubble Size</strong> and <strong>Bubble Color</strong>. In Figure <a
            href="#fig:bubblevars">8</a>, we take <strong>kids2000</strong> (percentage households with children under
          18), <strong>pubast00</strong> (percentage households receiving public assistance), and
          <strong>rent2002</strong> (median rent) as the three variables. We take the color for the <em>bubble</em> to
          be the same as the bubble size (<strong>rent2002</strong>).
        </p>
        <div class="figure" style="text-align: center"><span id="fig:bubblevars"></span>
          <img src="pics2b/22_bubblevars.png" alt="Bubble Chart variable selection" width="45%" />
          <p class="caption">
            Figure 8: Bubble Chart variable selection
          </p>
        </div>
        <p>The resulting graph, illustrated in Figure <a href="#fig:bubblechart">9</a> (after resizing the window
          somewhat), shows the same scatter plot as before, but now with the size and color of the circle reflecting the
          magnitude of the rent (red is high, blue is low). We see that the higher rents (larger bubbles) are situated
          in the lower left corner of the scatter plot. This suggests an interaction between the three variables, e.g.,
          the higher median rent tends to be in sub-boroughs with a small percentage of households with children or
          receiving public assistance. This interaction between the three variables is not something we might have
          expected a priori (or, maybe it is, but the graph brings it out more explicitly). The null case would be that
          there is no structural relationship between the two original variables and the third, resulting in a graph
          with the size/color of the bubbles randomly distributed throughout.</p>
        <div class="figure" style="text-align: center"><span id="fig:bubblechart"></span>
          <img src="pics2b/22_bubb_chart.png" alt="Bubble Chart" width="50%" />
          <p class="caption">
            Figure 9: Bubble Chart
          </p>
        </div>
        <div id="bubble-chart-options" class="section level4 unnumbered" number="">
          <h4>Bubble chart options</h4>
          <p>In addition to the usual options we have seen before, the bubble chart has a few unique features. The full
            list of main options is shown in Figure <a href="#fig:bubbleoptions">10</a>.</p>
          <p>An option specific to the bubble chart is to set the size of the bubble, with
            <strong>Adjust Bubble Size</strong> (the bottom item in the menu in Figure <a
              href="#fig:bubbleoptions">10</a>).
          </p>
          <div class="figure" style="text-align: center"><span id="fig:bubbleoptions"></span>
            <img src="pics2b/22_bubble_size.png" alt="Bubble Chart size adjustment" width="20%" />
            <p class="caption">
              Figure 10: Bubble Chart size adjustment
            </p>
          </div>
          <p>This brings up a dialog with a slider to change the size of the circles, as in Figure <a
              href="#fig:bubblesize">11</a>. This is particularly useful when the default size overwhelms the graph.
            Note that the slider dialog must
            be closed before moving on.</p>
          <div class="figure" style="text-align: center"><span id="fig:bubblesize"></span>
            <img src="pics2b/22_bubble_sizeadjust.png" alt="Bubble Chart size adjustment" width="50%" />
            <p class="caption">
              Figure 11: Bubble Chart size adjustment
            </p>
          </div>
          <p>Given the screen real estate taken up by the circles in the bubble chart, this is a technique that lends
            itself particularly well for small to medium sized data sets. For large size data sets, this particular
            graph is less appropriate.</p>
        </div>
        <div id="bubble-chart-using-categorical-variables" class="section level4 unnumbered" number="">
          <h4>Bubble chart using categorical variables</h4>
          <p>Another useful option is to select one of many
            <strong>Classification Themes</strong>. The default is the <strong>Standard Deviation</strong> theme, where
            the colors correspond to standard deviational units away from the mean (red colors above the mean, blue
            colors below the mean). The list
            of options contains the
            same classifications we encountered in the map Chapter, including custom categories.
          </p>
          <p>One particular useful feature is the <strong>Unique Values</strong> classification, in combination with
            setting the <strong>Size</strong> to
            a constant value. This is yet another way to show potential structural change in the data.</p>
          <p>Before we can illustrate this, we need to do some preliminary work. We first create a constant variable in
            the data table, by means of the <strong>Calculator</strong> –
            first use <strong>Add Variable</strong> to specify a name for the constant term (set it as an integer). In
            the <strong>Calculator</strong>,
            select <strong>Univariate</strong> and <strong>ASSIGN</strong> to set the constant value (e.g., 1).</p>
          <p>We also create a categorical variable, say <strong>manbronx</strong>, for the observations in Manhattan and
            the Bronx.
            We can again use the <strong>Selection Tool</strong> to first select all observations with
            <strong>bor_subb</strong> between 301 and 310 (inclusive),
            for Manhattan, and then <strong>Append to Current Selection</strong> the observations with values between
            101 and 110 (the Bronx).
            Finally, <strong>Save Selection</strong> as the <strong>manbronx</strong> variable.</p>
          <p>We create a new bubble chart and continue with <strong>kids2000</strong> and <strong>pubast00</strong> as
            the x and y-axis variables. However, now we set <strong>Bubble Size</strong>
            to the constant variable and <strong>Standard Deviation Color</strong> to <strong>manbronx</strong>. At this
            point, we select the option
            <strong>Classification Themes &gt; Unique Values</strong> for the color. The resulting bubble chart shows a
            scatter plot of
            the two variables of interest, with the bubble color corresponding to the values of the categorical
            variable,
            as in Figure <a href="#fig:bubblecat">12</a>. We can change the actual color of the bubble to create some
            more
            contrast by right clicking on the rectangle next to the category of interest and adjusting the <strong>Fill
              Color</strong>.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:bubblecat"></span>
            <img src="pics2b/22_bubb_manbronx.png" alt="Bubble Chart with categorical variable for color" width="50%" />
            <p class="caption">
              Figure 12: Bubble Chart with categorical variable for color
            </p>
          </div>
          <p>This use of a bubble chart to address structural change is particularly effective when more than two
            categories
            are involved. In such an instance, the
            binary selected/unselected logic of scatter plot brushing no longer works. Using the bubble chart in this
            fashion
            allows for an investigation of structural changes in the bivariate relationship between two variables along
            multiple categories, each represented by a different color bubble.</p>
        </div>
      </div>
      <div id="d-scatter-plot" class="section level3 unnumbered" number="">
        <h3>3D Scatter Plot</h3>
        <p>An explicit visualization of the relationship between three variables is possible in a
          three-dimensional scatter plot, a direct extension of the principles used in two dimensions to a
          three-dimensional data cube. Each of the dimensions of the cube corresponds to a variable, and the
          observations are shown as a point cloud in three dimensions (of course, projected onto the two-dimensional
          plane of our screen).</p>
        <p>This method is invoked as <strong>Explore &gt; 3D Scatter Plot</strong> from the menu, or by selecting the
          corresponding icon on the toolbar, as shown in Figure <a href="#fig:3dscattericon">13</a> (the third from the
          right in the EDA group).</p>
        <div class="figure" style="text-align: center"><span id="fig:3dscattericon"></span>
          <img src="pics2b/9_203_3dscaticon.png" alt="3D Scatter Plot toolbar icon" width="25%" />
          <p class="caption">
            Figure 13: 3D Scatter Plot toolbar icon
          </p>
        </div>
        <p>The choice brings up a variable selection dialog for the variables corresponding to the <strong>X</strong>,
          <strong>Y</strong> and <strong>Z</strong> dimensions. We stay with the same variables as before:
          <strong>kids2000</strong>, <strong>pubast00</strong>, and <strong>rent2002</strong>, as in Figure <a
            href="#fig:3dscattervars">14</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:3dscattervars"></span>
          <img src="pics2b/9_204_3dscat_vars.png" alt="3D Scatter Plot variable selection" width="40%" />
          <p class="caption">
            Figure 14: 3D Scatter Plot variable selection
          </p>
        </div>
        <p>The default 3D scatter plot in Figure <a href="#fig:3dscatter1">15</a> shows the data cube with the y-axis as
          vertical, and the z and x-axes as horizontal.</p>
        <div class="figure" style="text-align: center"><span id="fig:3dscatter1"></span>
          <img src="pics2b/33_3dplot.png" alt="3D Scatter Plot" width="60%" />
          <p class="caption">
            Figure 15: 3D Scatter Plot
          </p>
        </div>
        <div id="interacting-with-the-3d-scatter-plot" class="section level4 unnumbered" number="">
          <h4>Interacting with the 3D scatter plot</h4>
          <p>The data cube can be re-sized by zooming in and out. It is sometimes a bit ambiguous what is meant by
            these terms. For our purposes, we refer to zooming out as making the cube smaller, and zooming in as
            making the cube larger (getting into the cube, so to speak).</p>
          <p>The zoom functionality is carried out
            by pressing down on the track pad with
            two fingers and moving up (zoom out) or down (zoom in). Alternatively, one can press Control and press down
            on the
            track pad with one finger and move up or down. With a mouse, move the middle button up or down.</p>
          <p>In addition, the cube can be rotated by means of the pointer (click anywhere in the window and move the
            pointer
            to a different location by <em>dragging</em> the cube). The controls on the left-hand side of the view allow
            for the projection of the point cloud onto a given two-dimensional pane, and the construction of a selection
            box by checking the relevant boxes and/or moving the slider bar (see more below)</p>
          <p>For example, in Figure <a href="#fig:3dscatter2">16</a>, the cube has been zoomed out and the axes rotated
            such that Z is now vertical. With
            the <strong>Project to X-Y</strong> box checked on the left, a 2-dimensional scatter plot is projected onto
            the X-Y plane,
            i.e., showing the linear relationship between <strong>kids2000</strong> and <strong>pubast00</strong>.</p>
          <div class="figure" style="text-align: center"><span id="fig:3dscatter2"></span>
            <img src="pics2b/33_3dplot_2.png" alt="3D Scatter Plot zoom and project" width="60%" />
            <p class="caption">
              Figure 16: 3D Scatter Plot zoom and project
            </p>
          </div>
        </div>
        <div id="selection-in-the-3d-scatter-plot" class="section level4 unnumbered" number="">
          <h4>Selection in the 3D scatter plot</h4>
          <p>Selection in the three dimensional plot (or, rather, its two-dimensional projection) is a little tricky and
            takes some practice. The selection can be done either manually, by pressing down the command key while
            moving the pointer, or by using the guides under the selection check box.</p>
          <p>Checking the box next to <strong>Select</strong> creates a small red selection cube in the graph. This can
            be moved around with the command key pressed, or can be moved and resized by using the controls to the left.
          </p>
          <p>The first set of controls (to the left) move the box along the matching dimension, e.g., up or down the X
            values for larger or smaller values of the percentage households with kids, and the same for the other two
            variables. The control to the right changes the size of the box in the corresponding dimension (e.g., larger
            along the x dimension). The combination of these controls moves the box around to select observation points,
            with the selected points colored yellow.</p>
          <p>The most effective way to approach this is to combine moving around the selection box and rotating the
            cube.
            The reason for this is that the cube is in effect a perspective plot, and one cannot always judge exactly
            where the selection box is located in three-dimensional space.</p>
          <p>For example, let’s say we would like to select the observations in the very top of the Z corner in Figure
            <a href="#fig:3dscatter2">16</a>.
            We rotate the cube to get a better view of the relevant points and design a selection box, as in
            Figure <a href="#fig:3dselect1">17</a>. It seems like we are close to the points in question, but, in fact,
            only one
            observation is selected, as indicated by the yellow color.</p>
          <div class="figure" style="text-align: center"><span id="fig:3dselect1"></span>
            <img src="pics2b/33_3dselect1.png" alt="3D Scatter Plot selection -- 1" width="60%" />
            <p class="caption">
              Figure 17: 3D Scatter Plot selection – 1
            </p>
          </div>
          <p>Rotating the cube some more reveals what is going on. As shown in Figure <a href="#fig:3dselect2">18</a>,
            we are way too
            far from the points on the Y-axis, and need to move to smaller values for Y (lower percent public
            assistance).</p>
          <div class="figure" style="text-align: center"><span id="fig:3dselect2"></span>
            <img src="pics2b/33_3d_select2.png" alt="3D Scatter Plot selection -- 2" width="60%" />
            <p class="caption">
              Figure 18: 3D Scatter Plot selection – 2
            </p>
          </div>
          <p>Some further rotation and movement of the selection box eventually ends up with six selected (yellow)
            points,
            as in Figure <a href="#fig:3dselect3">19</a>. These points correspond to sub boroughs with high rent (high
            Z),
            low percent children (low X) and low percent public assistance (low Y).</p>
          <div class="figure" style="text-align: center"><span id="fig:3dselect3"></span>
            <img src="pics2b/33_3dselect3.png" alt="3D Scatter Plot selection -- 3" width="60%" />
            <p class="caption">
              Figure 19: 3D Scatter Plot selection – 3
            </p>
          </div>
          <p>From our earlier exploration of these data, we already know that these locations are in lower Manhattan.
            Indeed, the linking feature of <code>GeoDa</code> selects these same six observations in the map and in the
            bubble chart we just constructed. This confirms the association between low percentage kids, low assistance
            and high rent that we found earlier.</p>
          <div class="figure" style="text-align: center"><span id="fig:3dscatbrush"></span>
            <img src="pics2b/33_3dscat_link.png" alt="3D Scatter Plot selection cube" width="80%" />
            <p class="caption">
              Figure 20: 3D Scatter Plot selection cube
            </p>
          </div>
          <p>The linking and brushing feature also works in the reverse, where we can brush in any open view and the
            associated selection will be shown in the 3D scatter plot.</p>
          <p>Similar to what we observed for the bubble chart, the 3D scatter plot is most useful for small to medium
            sized data sets. For larger numbers of observations, the point cloud quickly becomes overwhelming and is no
            longer effective for visualization.</p>
        </div>
        <div id="d-scatter-options" class="section level4 unnumbered" number="">
          <h4>3D scatter options</h4>
          <p>The 3D scatter plot has a few specialized options, available either on the <strong>Data</strong> pane
            (which
            we have considered exclusively so far), or on the <strong>OpenGL</strong> pane. The latter gives the
            option to adjust the rendering quality of the points, their radius and the line thickness. These
            are fairly technical options that basically affect the quality of the graph and the speed
            by which it is updated. In most situations, the default settings are fine.</p>
          <p>Finally, under the <strong>Data</strong> button, there are the <strong>Show selection and
              neigbhors</strong> and <strong>Show connection line</strong>
            options. These items are relevant when a spatial weights matrix has been specified. We will return
            to this in later Chapters.</p>
        </div>
      </div>
    </div>
    <div id="true-multivariate-eda-parallel-coordinate-plot-and-conditional-plots" class="section level2 unnumbered"
      number="">
      <h2>True Multivariate EDA: Parallel Coordinate Plot and Conditional Plots</h2>
      <p>Once we move beyond three variables, it becomes difficult to visualize the actual
        multi-dimensional cloud plot that corresponds to the observations. Instead, we need to resort to creative ways
        to reduce the dimensionality to something we can show in a standard two-dimensional view. Two methods that take
        a different approach to this problem are the <em>parallel coordinate plot</em> (PCP) and <em>conditional</em>
        plots.</p>
      <div id="parallel-coordinate-plot-pcp" class="section level3 unnumbered" number="">
        <h3>Parallel Coordinate Plot (PCP)</h3>
        <div id="principle-1" class="section level4 unnumbered" number="">
          <h4>Principle</h4>
          <p>The parallel coordinate plot or PCP is designed to visually identify clusters and patterns in a
            multi-dimensional variable space. Originally suggested by <span class="citation">Inselberg (<a
                href="#ref-Inselberg:85" role="doc-biblioref">1985</a>; see also Inselberg and Dimsdale <a
                href="#ref-InselbergDimsdale:90" role="doc-biblioref">1990</a>)</span>,
            it has become a main feature in many visual data mining frameworks
            <span class="citation">(e.g., Wegman <a href="#ref-Wegman:90" role="doc-biblioref">1990</a>; Wegman and
              Dorfman <a href="#ref-WegmanDorfman:03" role="doc-biblioref">2003</a>)</span>.
          </p>
          <p>In a PCP, each variable is represented as a (parallel) axis, and each observation consists of a line that
            connects points on the axes. <em>Clusters</em> are identified as groups of lines (i.e., observations) that
            follow a similar path. This is equivalent to points that are close together in multidimensional variable
            space. Unlike the latter, which can only be visualized for up to three dimensions (e.g., in the 3D scatter
            plot), the PCP can be applied to a large number of variables. The only limitation is human perception and
            screen real estate.</p>
          <p><em>Outliers</em> in a PCP are lines that show a very different pattern from the rest, similar to outlying
            points in a multi-dimensional cloud.</p>
        </div>
        <div id="creating-a-pcp" class="section level4 unnumbered" number="">
          <h4>Creating a PCP</h4>
          <p>The PCP functionality is invoked from the menu as <strong>Explore &gt; Parallel Coordinate Plot</strong>,
            or by means of the PCP toolbar icon, shown in Figure <a href="#fig:pcpicon">21</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpicon"></span>
            <img src="pics2b/10_212_pcpicon.png" alt="PCP toolbar icon" width="25%" />
            <p class="caption">
              Figure 21: PCP toolbar icon
            </p>
          </div>
          <p>In the familiar way, clicking on this icon brings up a variable selection dialog. In the same
            manner as for the scatter plot matrix, we move variables from the left column to the right
            <strong>Include</strong> column using the arrows (or by double clicking on the variable name).</p>
          <p>In our example, shown in Figure <a href="#fig:pcpvars">22</a>, we will start with the same three variables
            as before, <strong>kids2000</strong>, <strong>pubast00</strong>,
            and <strong>rent2002</strong>, in order to illustrate the similarity between lines in the PCP and points in
            the 3D scatter plot.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpvars"></span>
            <img src="pics2b/44_pcp_3vars.png" alt="PCP variable selection" width="40%" />
            <p class="caption">
              Figure 22: PCP variable selection
            </p>
          </div>
          <p>Pressing OK brings us the default PCP.
            Each axis in the plot corresponds to one observation.
            In our example, shown in Figure <a href="#fig:pcpdefault">23</a>, the top line represents
            <strong>kids2000</strong>, the middle
            line <strong>pubast00</strong>, and the bottom line <strong>rent2002</strong>.</p>
          <p>On each axis, an observations is represented by a point. The points for the same observation are connected
            between the axes. Each line thus corresponds with a point in three-dimensional attribute space.</p>
          <p>The default PCP in <code>GeoDa</code> has the basic green colors, similar to the <strong>Themeless</strong>
            base map. Next to each
            axis, some descriptive statistics (mean, standard deviation) are
            listed (this is the default, but it can be changed with the <strong>Display</strong> option).</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpdefault"></span>
            <img src="pics2b/44_defaultpcp.png" alt="Default PCP" width="50%" />
            <p class="caption">
              Figure 23: Default PCP
            </p>
          </div>
        </div>
        <div id="clusters-and-outliers-in-pcp" class="section level4 unnumbered" number="">
          <h4>Clusters and outliers in PCP</h4>
          <p>In order the illustrate the match between lines in the PCP and points in multi-attribute variable space,
            we consider again the six selected observations from the 3D scatter plot. We noticed that five of these six
            sub-boroughs in Manhattan were very similar, as evidenced by their location close together in the corner
            of the 3D scatter plot, with one point slightly further away. This is evidenced in the right hand panel
            of Figure <a href="#fig:pcp3d1">24</a>, obtained by zooming in on the selected points in the 3D data cube.
          </p>
          <p>Due to the linking feature, the six selected points are shown as six selected lines in the PCP,
            in the left hand panel of
            Figure <a href="#fig:pcp3d1">24</a>. This illustrates the match between the six lines in the PCP and the six
            points
            in the 3D scatter plot.</p>
          <p>Five of the lines closely follow the same pattern, i.e., they cluster. This
            corresponds to a tight clump of points in the 3D scatter plot. The point that is slightly further away
            is shown as a line that does not quite follow the overall path of the other five.</p>
          <p><em>Visual cluster detection</em> <span class="citation">(e.g., Wegman and Dorfman <a
                href="#ref-WegmanDorfman:03" role="doc-biblioref">2003</a>)</span> consists of locating groups of lines
            in the PCP
            that follow a similar path.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcp3d1"></span>
            <img src="pics2b/44_pcp_3d_cluster.png" alt="Clusters in PCP and 3D scatter plot" width="80%" />
            <p class="caption">
              Figure 24: Clusters in PCP and 3D scatter plot
            </p>
          </div>
          <p>Similarly, we can identify <em>outlier</em> observations as lines in the PCP are are very far from the
            general
            pattern. These correspond to data points that are far from the main data cloud in the 3D scatter plot.</p>
          <p>For example, in Figure <a href="#fig:pcp3d2">25</a>, we identify an observation that is located in the very
            far
            corner of the data cube, highlighted in yellow, somewhat removed from the main data cloud. This point
            corresponds to a line
            in the PCP that moves from one extreme on both <strong>kids2000</strong> and <strong>pubast00</strong> axes
            (i.e., high values),
            to the other extreme on the <strong>rent2002</strong> axis (i.e., low value).
            In other words, this is a
            neighborhood with a high proportion of children, a lot of public assistance and low rent
            (although possibly the low rent is due to a suspicious value of zero, as we have seen earlier).</p>
          <p>The main point is that outliers in multi-attribute variable space correspond to lines that
            do not follow the overall trend or paths in the PCP.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcp3d2"></span>
            <img src="pics2b/44_pcp_3d_outlier.png" alt="Outlier in PCP and 3D scatter plot" width="80%" />
            <p class="caption">
              Figure 25: Outlier in PCP and 3D scatter plot
            </p>
          </div>
        </div>
        <div id="multi-variable-pcp" class="section level4 unnumbered" number="">
          <h4>Multi-variable PCP</h4>
          <p>The real power of the PCP is when multiple variables are considered, when effective visualization of
            the multi-attribute data hypercube is no longer possible. To illustrate this, we use five different
            variables: <strong>rent2008</strong>, <strong>kids2008</strong>, <strong>rentpct08</strong>,
            <strong>yrhom08</strong>, and <strong>hhsiz08</strong>. In Figure <a href="#fig:pcpmulti">26</a>,
            we selected four observations that follow a strikingly similar path on these five variables. As it turns
            out,
            these are sub-boroughs in lower Manhattan that also <em>cluster</em> together on these variables following a
            k-means
            clustering routine. In a later chapter, we show how PCP can thus be used to illustrate the variable
            structure underlying
            the clusters, but here we move in the opposite direction. Of course, finding these patterns visually can be
            quite a challenge.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpmulti"></span>
            <img src="pics2b/44_pcp_multivar.png" alt="Multi-variable PCP" width="50%" />
            <p class="caption">
              Figure 26: Multi-variable PCP
            </p>
          </div>
        </div>
        <div id="pcp-options" class="section level4 unnumbered" number="">
          <h4>PCP options</h4>
          <p>The options for the PCP, listed in Figure <a href="#fig:pcpthemes">27</a>, include all the standard
            features we have seen before. We do not discuss them again.</p>
          <p>One special feature is the choice of <strong>Classification Themes</strong>. This allows for all of the
            themes available for choropleth maps to be applied to the variable listed originally <em>at the top</em> in
            the PCP.</p>
          <p>Changing the
            color theme may make it a little easier to compare the pattern of the observations for one variable to the
            relative order of those observations for other variables, although colors are notoriously poor in
            distinguishing subtle variation in values.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
            Therefore, as shown in Figure <a href="#fig:pcpthemes">27</a>, the default of <strong>Themeless</strong> is
            preferred.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpthemes"></span>
            <img src="pics2b/10_216_pcp_options.png" alt="PCP options" width="25%" />
            <p class="caption">
              Figure 27: PCP options
            </p>
          </div>
          <p>It often makes sense to change the order of the axes (variables) to bring out patterns of clustering (or
            outliers) more clearly. This is accomplished by dragging the circle associated with each axis to a different
            location. For example, in Figure <a href="#fig:pcpmove1">28</a>, we drag the circle associated with
            <strong>yrhom08</strong> up to move it to the second spot, above <strong>rentpc08</strong>.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpmove1"></span>
            <img src="pics2b/44_pcp_moveaxes.png" alt="Moving the axes for PCP" width="50%" />
            <p class="caption">
              Figure 28: Moving the axes for PCP
            </p>
          </div>
          <p>The result is shown in Figure <a href="#fig:pcpmove2">29</a>. Realligning the axes in this manner can often
            bring out patterns
            in the data. However, in practice, it is not always clear which is the optimal alignment.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpmove2"></span>
            <img src="pics2b/44_pcp_axes_moved.png" alt="PCP with axes moved" width="50%" />
            <p class="caption">
              Figure 29: PCP with axes moved
            </p>
          </div>
        </div>
        <div id="brushing-the-pcp" class="section level4 unnumbered" number="">
          <h4>Brushing the PCP</h4>
          <p>Just like the scatter plot, the PCP can be <strong>brushed</strong>. In Figure <a
              href="#fig:pcpbrush1">30</a>, using a rectangular selection shape, the six highest values for
            <strong>rent2008</strong> are selected. The pattern that results (only the selected observations, or lines,
            are highlighted in the graph), shows how these observations track closely for the variables considered here.
            This is a typical pattern for a <strong>visual cluster</strong> detected in the PCP. The rectangle can be
            moved along the axis for <strong>rent2008</strong> to see how other clusters may reveal
            themselves. Alternatively, the <em>brush</em> can be created on any of the other axes to proceed in a
            similar way.</p>
          <div class="figure" style="text-align: center"><span id="fig:pcpbrush1"></span>
            <img src="pics2b/44_pcp_brush.png" alt="Brushing the PCP" width="50%" />
            <p class="caption">
              Figure 30: Brushing the PCP
            </p>
          </div>
          <p>As always, the selection in the PCP is immediately linked to all the other open views. The brushing process
            can also be initiated in any of the other open views.</p>
        </div>
      </div>
      <div id="conditional-plots" class="section level3 unnumbered" number="">
        <h3>Conditional Plots</h3>
        <div id="principle-2" class="section level4 unnumbered" number="">
          <h4>Principle</h4>
          <p>Conditional plots, also known as facet graphs or Trellis graphs <span class="citation">(Becker, Cleveland,
              and Shyu <a href="#ref-Beckeretal:96" role="doc-biblioref">1996</a>)</span>, provide a means to assess
            interactions between more than two variables. Multiple graphs or maps are constructed for different subsets
            of the observations, obtained as a result of <em>conditioning</em> on the value of two variables. We have
            already covered conditional maps in the mapping Chapter. Here, we consider conditional scatter plots,
            histograms and box plots.</p>
        </div>
        <div id="creating-conditional-scatter-plots" class="section level4 unnumbered" number="">
          <h4>Creating conditional scatter plots</h4>
          <p>Each of the three conditional plots is started from the <strong>Conditional Plot</strong> icon on the
            toolbar, the right most
            icon in the EDA group. This brings up a list that provides four types of plot options, shown in Figure <a
              href="#fig:condplotoption">31</a>. Alternatively, the same can be accomplished from the menu, by means of
            <strong>Explore &gt; Conditional Plot</strong>, followed by the choice of <strong>Histogram</strong>,
            <strong>Scatter Plot</strong>, or <strong>Box Plot</strong> (as we have seen, the conditional map
            functionality can also be started from the map menu, as <strong>Map &gt; Conditional Map</strong>).</p>
          <div class="figure" style="text-align: center"><span id="fig:condplotoption"></span>
            <img src="pics2b/55_cond_icons.png" alt="Conditional plot toolbar options" width="10%" />
            <p class="caption">
              Figure 31: Conditional plot toolbar options
            </p>
          </div>
          <p>The four variables required are selected in the variables selection dialog
            shown in Figure <a href="#fig:condplotvars">32</a>. Not only are there the conditioning variables for the x
            and y axes that need to be chosen, but also the two variables for the scatter plot itself. In our example,
            we have taken <strong>hhsiz00</strong> (median household size in 2000), <strong>yrhom02</strong> (average
            number of years lived in current residence, for 2002) as the two conditioning variables. The scatter plot is
            constructed with <strong>kids2000</strong> (% households with kids under 18 in 2000) on the x-axis and
            <strong>pubast00</strong> (% households receiving public assistance in 2000) on the y-axis.</p>
          <div class="figure" style="text-align: center"><span id="fig:condplotvars"></span>
            <img src="pics2b/11_225_condscatplotvars.png" alt="Conditional Scatter Plot variable selection"
              width="60%" />
            <p class="caption">
              Figure 32: Conditional Scatter Plot variable selection
            </p>
          </div>
          <p>The default plot consists of a 3 x 3 arrangement. In our example in Figure <a
              href="#fig:condplot3x3">33</a>, the subsetting is too fine grained for 55 observations, since several
            cells have only minimal observations (e.g., 2, 3 and 4).</p>
          <div class="figure" style="text-align: center"><span id="fig:condplot3x3"></span>
            <img src="pics2b/55_cond_scatter1.png" alt="3x3 Conditional Scatter Plot" width="80%" />
            <p class="caption">
              Figure 33: 3x3 Conditional Scatter Plot
            </p>
          </div>
        </div>
        <div id="changing-the-conditioning" class="section level4 unnumbered" number="">
          <h4>Changing the conditioning</h4>
          <p>The options menu provides a way to change the number of categories as well as the break points. The
            <strong>Vertical Bins Breaks</strong> and <strong>Horizontal Bins Breaks</strong> contain all the standard
            interval conventions, as well as the possibility to create custom cut-off points.</p>
          <p>In our example, illustrated in Figure <a href="#fig:binbreaks">34</a>, we switch from a 3x3 setup to a 2x2
            arrangement by selecting the median (<strong>Quantile &gt; 2</strong>) as the break point for each of the
            conditioning variables.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
          <p>More precisely, a breakpoint is chosen that splits the number
            of observations into two equal parts (as close as possible). However, since the median can itself correspond
            to an observation (for an uneven number of observations, as is the case in our example),
            the cut-off value shown in the graph can be slightly different from the actual median.</p>
          <p>For example,
            the median for <strong>hhsiz00</strong> (e.g., as obtained from the descriptive statistics listed with a
            box plot) is 2.7176, whereas the cut-off value shown for the horizontal axis of the graph is 2.703.
            In addition, when there are many tied observations, the break points are chosen such that the
            resulting categories are as close as possible to the specified requirements. In any event, the
            breaks can also be set explicitly by means of the <strong>Custom Breaks</strong> option, which was covered
            in the Mapping chapter.</p>
          <div class="figure" style="text-align: center"><span id="fig:binbreaks"></span>
            <img src="pics2b/11_227_binbreaks.png" alt="Adjusting bin breaks" width="40%" />
            <p class="caption">
              Figure 34: Adjusting bin breaks
            </p>
          </div>
          <p>By default, a linear fit is shown through the scatter plots (<strong>Show Linear Smoother</strong>), and
            for
            each plot, axes tick points (<strong>View &gt; Display Axes Scale Values</strong>) and the slope value
            (<strong>View &gt; Display Slope Values</strong>) are displayed by default. These settings
            are illustrated in Figure <a href="#fig:condfit">35</a>. As in the scatter plot matrix, the regression
            slopes are highlighted as significant by means of one (p &lt; 0.05) or two asterisks (p &lt; 0.01).</p>
          <div class="figure" style="text-align: center"><span id="fig:condfit"></span>
            <img src="pics2b/55_cond_scatter2.png" alt="2x2 Conditional Scatter Plot" width="80%" />
            <p class="caption">
              Figure 35: 2x2 Conditional Scatter Plot
            </p>
          </div>
          <p>The result in Figure <a href="#fig:condfit">35</a> suggest a positive and significant slope between the
            number of kids and the degree of public assistance for those neighborhoods with more residential transition
            (smaller number of years lived in residence), as shown in the two graphs at the bottom. The slope is almost
            four times steeper in neighborhoods with larger household size (lower-right graph). However, the
            relationship is not significant for the more residentially stable neighborhoods (number of years lived in
            residence above the median), irrespective of the household size (top two graphs).</p>
          <p>Finally, the options also allow for a LOWESS smoother to be applied to the scatter plot points
            (by checking <strong>Show LOWESS Smoother</strong> in the options). However, regimes regression is
            <em>not</em> available,
            since selection is reflected in the conditioning.</p>
        </div>
        <div id="conditional-histogram" class="section level4 unnumbered" number="">
          <h4>Conditional histogram</h4>
          <p>A conditional histogram follows the same principle and
            shows the distribution of a target variable for subsets of the data as determined by intervals
            for the conditional variables. It is selected as the second item in the list of conditional plots,
            shown in Figure <a href="#fig:condplotoption">31</a>.</p>
          <p>We proceed in the same way as for the conditional scatter plot and select <strong>hhsiz00</strong> and
            <strong>yrhom02</strong> as the conditioning variables for the target variable <strong>pubast00</strong>, as
            illustrated in the variable selection dialog in Figure <a href="#fig:condhistvars">36</a>.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:condhistvars"></span>
            <img src="pics2b/12_899_condhistvars.png" alt="Conditional Histogram variable selection" width="50%" />
            <p class="caption">
              Figure 36: Conditional Histogram variable selection
            </p>
          </div>
          <p>In order to obtain a somewhat meaningful result, we again adjust the horizontal and vertical bin
            sizes to end up with the 2 by 2 plot shown in Figure <a href="#fig:condhist">37</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:condhist"></span>
            <img src="pics2b/12_900_condhistogram.png" alt="2x2 Conditional Histogram" width="50%" />
            <p class="caption">
              Figure 37: 2x2 Conditional Histogram
            </p>
          </div>
          <p>We cannot distinguish a meaningful difference between the plots in the top part of the graph, i.e.,
            for those sub-boroughs with a higher percentage of long-term residents, the distributon of the
            percentage public assistance does not seem to depend on the median household size. However, in the bottom
            part of the graph, there is a suggestion that in sub-boroughs characterized by a higher turnover
            in residents and with larger median household size, there is a higher percentage public assistance.</p>
          <p>As always in an exploratory exercise, this is just a suggestion, and it would need to be
            further quantified in the form of a precise hypothesis test.</p>
        </div>
        <div id="conditional-box-plot" class="section level4 unnumbered" number="">
          <h4>Conditional box plot</h4>
          <p>A final conditional plot is the box plot, invoked as the last item in the list in Figure <a
              href="#fig:condplotoption">31</a>.
            This is an alternative to the conditional histogram to portray a univariate distributions conditioned on two
            other variables.</p>
          <p>In addition, the conditional box plot is particularly useful when the conditioning is only on one dimension
            and the
            conditioning variable is categorical. This is yet another way to investigate the potential for spatial
            heterogeneity,
            when the conditioning variable is an indicator or categorical variable that corresponds to spatial subsets
            of the data.</p>
          <p>For example, in Figure <a href="#fig:condboxvar">38</a>, we illustrate the variable selection with the
            conditioning variable
            as <strong>manbronx</strong>, the same indicator variable we used before. The second conditioning variable
            is left blank. As a
            result, the conditioning pertains only the horizontal dimension. We choose the variable of interest as
            <strong>kids2000</strong>.
            Note how the variable for the <strong>Vertical Cells</strong> is kept blank, ensuring a one-dimensional
            conditioning.</p>
          <div class="figure" style="text-align: center"><span id="fig:condboxvar"></span>
            <img src="pics2b/55_cond_boxplot_vars.png" alt="Conditional box plot variable selection" width="50%" />
            <p class="caption">
              Figure 38: Conditional box plot variable selection
            </p>
          </div>
          <p>The first result is not very good. As we saw earlier for other graphs, the binning on the conditioning
            axes is designed for continuous variables and needs to be adjusted for categorical or binary variables.
            As shown in Figure <a href="#fig:condboxuniq">39</a>, we fix this problem by selecting <strong>Unique
              Values</strong> as the classification.</p>
          <div class="figure" style="text-align: center"><span id="fig:condboxuniq"></span>
            <img src="pics2b/55_cond_boxplot_1.png" alt="Conditional box plot unique value classification"
              width="60%" />
            <p class="caption">
              Figure 39: Conditional box plot unique value classification
            </p>
          </div>
          <p>The new graph in Figure <a href="#fig:condbox">40</a> now shows the distribution for
            <strong>kids2000</strong> in side by side box plots for the percentage
            households with children for the neighborhoods in
            Manhattan and the Bronx (1) and the rest of the city (0). While both the mean and median are clearly lower
            in Manhattan-Bronx, the spread of the distribution is such that the difference is unlikely to be
            significant.
            This is confirmed by a difference in means test using the Averages Chart (not shown), which yields a p-value
            of 0.142.</p>
          <div class="figure" style="text-align: center"><span id="fig:condbox"></span>
            <img src="pics2b/55_cond_boxplot_2.png" alt="Conditional box plot for two subregions" width="60%" />
            <p class="caption">
              Figure 40: Conditional box plot for two subregions
            </p>
          </div>
          <p>In contrast, if we create an indicator variable for just Manhattan (<strong>bor_subb</strong> in the 300
            range), the result
            is much more convincing, as in Figure <a href="#fig:condbox2">41</a>. Here, the mean and median are clearly
            different between the
            two distributions, providing a more visual alternative to the Averages Chart difference in means test shown
            in the previous Chapter.</p>
          <div class="figure" style="text-align: center"><span id="fig:condbox2"></span>
            <img src="pics2b/55_cond_boxplot_3.png" alt="Conditional box plot for Manhattan and rest" width="60%" />
            <p class="caption">
              Figure 41: Conditional box plot for Manhattan and rest
            </p>
          </div>
          <p>A particularly useful application of the conditional box plot is to show the distribution for a variable
            across
            different cluster categories, indicated by a categorical variable. We return to this in a later Chapter.</p>
        </div>
      </div>
    </div>
    <div id="references" class="section level2 unnumbered" number="">
      <h2>References</h2>
      <div id="refs" class="references hanging-indent">
        <div id="ref-Beckeretal:96">
          <p>Becker, Richard A., W. S. Cleveland, and M-J. Shyu. 1996. “The Visual Design and Control of Trellis
            Displays.” <em>Journal of Computational and Graphical Statistics</em> 5: 123–55.</p>
        </div>
        <div id="ref-Inselberg:85">
          <p>Inselberg, A. 1985. “The Plane with Parallel Coordinates.” <em>Visual Computer</em> 1: 69–91.</p>
        </div>
        <div id="ref-InselbergDimsdale:90">
          <p>Inselberg, Alfred, and B. Dimsdale. 1990. “Parallel Coordinates: A Tool for Visualizing Multi-Dimensional
            Geometry.” <em>Proceedings of the IEEE Visualization 90</em>, 361–78.</p>
        </div>
        <div id="ref-Wegman:90">
          <p>Wegman, Edward J. 1990. “Hyperdimensional Data Analysis Using Parallel Coordinates.” <em>Journal of the
              American Statistical Association</em> 85: 664–75.</p>
        </div>
        <div id="ref-WegmanDorfman:03">
          <p>Wegman, Edward J., and Alan Dorfman. 2003. “Visualizing Cereal World.” <em>Computational Statistics and
              Data Analysis</em> 43 (4): 633–49.</p>
        </div>
      </div>
    </div>
    <div class="footnotes">
      <hr />
      <ol>
        <li id="fn1">
          <p>University of Chicago, Center for Spatial Data Science – <a href="mailto:anselin@uchicago.edu"
              class="email">anselin@uchicago.edu</a><a href="#fnref1" class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn2">
          <p>In addition, the color scheme remains attached to the variable that
            was originally listed at the top, even if the axis corresponding to that variables is later moved to
            a different position.<a href="#fnref2" class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn3">
          <p>Note that the break point convention can be different for the horizontal and vertical axes, such as, 3
            categories vertically and 2 horizontally.<a href="#fnref3" class="footnote-back">↩︎</a></p>
        </li>
      </ol>
    </div>

    <footer class="site-footer">
      <span class="site-footer-owner"><a href="https://github.com/lixun910/geoda">GeoDa</a> is maintained by <a
          href="#">lixun910</a>.</span>
      <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>
        using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a
          href="https://twitter.com/jasonlong">Jason Long</a>.</span>
    </footer>

  </section>


  <!-- code folding -->


  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>

</html>