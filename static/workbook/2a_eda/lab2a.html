<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="author" content="Luc Anselin" />


  <title>Exploratory Data Analysis (1)</title>

  <script src="lab2a_files/header-attrs-2.3/header-attrs.js"></script>
  <link href="lab2a_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
  <script src="lab2a_files/highlightjs-9.12.0/highlight.js"></script>
  <title>GeoDa on Github</title>

  <style>
    * {
      margin: 0;
      padding: 0;
    }

    .shadowfilter {
      -webkit-filter: drop-shadow(12px 12px 7px rgba(0, 0, 0, 0.5));
      filter: url(shadow.svg#drop-shadow);
    }

    .intro1 {
      margin-left: -45px;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/normalize.css" media="screen">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="https://geodacenter.github.io/stylesheets/github-light.css"
    media="screen">
  <link rel="stylesheet" href="https://geodacenter.github.io/stylesheets/simple-slideshow-styles.css">
  <style>
    ul {
      padding-left: 30px;
    }

    figcaption {
      top: .70em;
      left: .35em;
      bottom: auto !important;
      right: auto !important;
    }
  </style>

  <style>
    h1 {
      text-align: center;
    }

    h3.subtitle {
      text-align: center;
    }

    h4.author {
      text-align: center;
    }

    h4.date {
      text-align: center;
    }

    p.caption {
      font-size: 12px;
    }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LC0QJ53WFS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-LC0QJ53WFS');
  </script>
  <!-- End Google tag -->

  <style type="text/css">
    code {
      white-space: pre;
    }
  </style>
  <script type="text/javascript">
    if (window.hljs) {
      hljs.configure({ languages: [] });
      hljs.initHighlightingOnLoad();
      if (document.readyState && document.readyState === "complete") {
        window.setTimeout(function () { hljs.initHighlighting(); }, 0);
      }
    }
  </script>








</head>

<body>


  <section class="main-content">


    <h1 class="title toc-ignore">Exploratory Data Analysis (1)</h1>
    <h3 class="subtitle">Univariate and Bivariate Analysis</h3>
    <h4 class="author">Luc Anselin<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h4>
    <h4 class="date">09/28/2020 (updated)</h4>


    <div id="TOC">
      <ul>
        <li><a href="#introduction">Introduction</a>
          <ul>
            <li><a href="#objectives">Objectives</a>
              <ul>
                <li><a href="#geoda-functions-covered">GeoDa functions covered</a></li>
              </ul>
            </li>
            <li><a href="#preliminaries">Preliminaries</a></li>
          </ul>
        </li>
        <li><a href="#analyzing-the-distribution-of-a-single-variable">Analyzing the Distribution of a Single
            Variable</a>
          <ul>
            <li><a href="#histogram">Histogram</a>
              <ul>
                <li><a href="#selecting-the-number-of-histogram-bins">Selecting the number of histogram bins</a></li>
                <li><a href="#using-a-custom-classification">Using a custom classification</a></li>
                <li><a href="#histograms-for-categorical-variables">Histograms for categorical variables</a></li>
                <li><a href="#display-histogram-statistics">Display histogram statistics</a></li>
                <li><a href="#other-histogram-options">Other histogram options</a></li>
                <li><a href="#linking-a-histogram-and-a-map">Linking a histogram and a map</a></li>
              </ul>
            </li>
            <li><a href="#box-plot">Box Plot</a>
              <ul>
                <li><a href="#box-plot-options">Box plot options</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#bivariate-analysis-the-scatter-plot">Bivariate Analysis: The Scatter Plot</a>
          <ul>
            <li><a href="#scatter-plot-basics">Scatter Plot basics</a>
              <ul>
                <li><a href="#default-settings">Default settings</a></li>
                <li><a href="#scatter-plot-options">Scatter Plot options</a></li>
                <li><a href="#correlation">Correlation</a></li>
              </ul>
            </li>
            <li><a href="#smoothing-the-scatter-plot">Smoothing the scatter plot</a>
              <ul>
                <li><a href="#lowess-parameters">LOWESS parameters</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#spatial-heterogeneity">Spatial Heterogeneity</a>
          <ul>
            <li><a href="#averages-chart">Averages Chart</a>
              <ul>
                <li><a href="#map-brushing-and-the-averages-chart">Map brushing and the Averages Chart</a></li>
              </ul>
            </li>
            <li><a href="#brushing-the-scatter-plot">Brushing the Scatter Plot</a>
              <ul>
                <li><a href="#map-brushing-and-scatter-plot">Map brushing and scatter plot</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
      </ul>
    </div>

    <p><br></p>
    <div id="introduction" class="section level2 unnumbered" number="">
      <h2>Introduction</h2>
      <p>In this Chapter, we will begin to explore the EDA functionality in <code>GeoDa</code>, in particular the
        methods
        that deal with one or two variables. We leave the treatment of multiple variables for the
        next Chapter. We also illustrate the powerful linking and brushing capability that is central to the
        architecture of the program. We start with the description and visualization of a single variable,
        and then move on to the bivariate scatter plot and an exploration of spatial heterogeneity.</p>
      <p>We will again use a data set with demographic and socio-economic information for 55 New York City sub-boroughs.
      </p>
      <div id="objectives" class="section level3 unnumbered" number="">
        <h3>Objectives</h3>
        <ul>
          <li>
            <p>Computing descriptive statistics and creating visualizations of the distribution of a single variable
              (histogram, box plot)</p>
          </li>
          <li>
            <p>Interpreting a scatter plot and scatter plot smoothing (LOWESS)</p>
          </li>
          <li>
            <p>Carrying out scatter plot brushing and linking</p>
          </li>
          <li>
            <p>Assessing spatial heterogeneity by means of the Averages Chart</p>
          </li>
          <li>
            <p>Assessing spatial heterogeneity through the Chow test</p>
          </li>
        </ul>
        <div id="geoda-functions-covered" class="section level4 unnumbered" number="">
          <h4>GeoDa functions covered</h4>
          <ul>
            <li>Linking and brushing graphs and maps</li>
            <li>Variable settings dialog</li>
            <li>Explore &gt; Histogram
              <ul>
                <li>Choose Intervals option</li>
                <li>Histogram Classification option</li>
                <li>View &gt; Set as Unique Value</li>
                <li>View &gt; Display Statistics option</li>
              </ul>
            </li>
            <li>Explore &gt; Box Plot
              <ul>
                <li>Hinge option</li>
              </ul>
            </li>
            <li>Explore &gt; Scatter Plot
              <ul>
                <li>View &gt; Display Precision option</li>
                <li>Data option</li>
                <li>Smoother option</li>
                <li>LOWESS parameters setting</li>
                <li>Regimes Regression option and Chow test</li>
              </ul>
            </li>
            <li>Explore &gt; Averages Chart</li>
          </ul>
          <p><br></p>
        </div>
      </div>
      <div id="preliminaries" class="section level3 unnumbered" number="">
        <h3>Preliminaries</h3>
        <p>We will continue to illustrate the various operations by means of the data set with demographic and
          socio-economic information for 55 New York City sub-boroughs that comes built-in with <code>GeoDa</code>. It
          is also
          contained in the <a href="https://geodacenter.github.io/data-and-lab/">GeoDa Center data set collection</a>.
        </p>
        <ul>
          <li><a href="https://geodacenter.github.io/data-and-lab/nyc/">nyc</a>: socio-economic data for 55 New York
            City sub-boroughs</li>
        </ul>
        <p><br></p>
        <p>As before, since the data set is built-in, there is no real need to download the sample data, although it is
          useful in order to preserve
          any changes. Also, if earlier you created a project file to contain the custom map classification, you should
          load this <strong>gda</strong>
          file instead.</p>
        <p>We will focus our attention on the functionality of the <strong>Explore</strong> menu, listed
          in Figure <a href="#fig:exploremenu">1</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:exploremenu"></span>
          <img src="pics2a/0_explore_menu.png" alt="Explore menu items" width="20%" />
          <p class="caption">
            Figure 1: Explore menu items
          </p>
        </div>
        <p>The counterpart to the menu items are the collection of eight icons on the main toolbar,
          shown in Figure <a href="#fig:exploretool">2</a>. The icon for the <strong>Averages Chart</strong> is
          separate,
          and is considered further below.</p>
        <div class="figure" style="text-align: center"><span id="fig:exploretool"></span>
          <img src="pics2a/0_explore_icons.png" alt="Explore toolbar icons" width="30%" />
          <p class="caption">
            Figure 2: Explore toolbar icons
          </p>
        </div>
        <p>The first two icons on the left pertain to univariate analyses, respectively the <strong>Histogram</strong>
          and <strong>Box Plot</strong>. The <strong>Scatter Plot</strong> extends this to bivariate association. The
          other
          icons pertain to the analysis of multiple variables, which we leave to the next Chapter to
          consider.</p>
      </div>
    </div>
    <div id="analyzing-the-distribution-of-a-single-variable" class="section level2 unnumbered" number="">
      <h2>Analyzing the Distribution of a Single Variable</h2>
      <div id="histogram" class="section level3 unnumbered" number="">
        <h3>Histogram</h3>
        <p>We begin our analysis with the simple description of the distribution of a single variable. Arguably the most
          familiar statistical graphic is the histogram, which is a discrete representation of the density function of a
          variable. In essence, the range of the variable (the difference between maximum and minimum) is divided into a
          number of equal intervals (or bins), and the number of observations that fall within each bin is depicted in a
          bar graph.</p>
        <p>The histogram functionality is started by selecting <strong>Explore &gt; Histogram</strong> from the menu, or
          by clicking on the <strong>Histogram</strong> toolbar icon, the left-most icon in the set in Figure <a
            href="#fig:exploretool">2</a>.</p>
        <p>This brings up the <strong>Variable Settings</strong> dialog, which lists all the numeric variables in the
          data set (string variables cannot be analyzed). Scroll down the list as in Figure <a
            href="#fig:histvarlist">3</a> until you can select <strong>kids2000</strong>, the percentage of households
          with kids under age 18 in 2000. This is the same variable we used to illustrate some of
          the mapping functionality.</p>
        <div class="figure" style="text-align: center"><span id="fig:histvarlist"></span>
          <img src="pics2a/00_kids2000.png" alt="Histogram variable selection" width="15%" />
          <p class="caption">
            Figure 3: Histogram variable selection
          </p>
        </div>
        <p>After clicking <strong>OK</strong>, the default histogram appears, showing the distribution of the 55
          observations over seven bins, as in Figure <a href="#fig:defaulthist">4</a>.
          Interestingly, we find that the second bin lacks observations, suggesting that a different set of intervals
          may be
          more appropriate.</p>
        <div class="figure" style="text-align: center"><span id="fig:defaulthist"></span>
          <img src="pics2a/00_histogram.png" alt="Default histogram" width="40%" />
          <p class="caption">
            Figure 4: Default histogram
          </p>
        </div>
        <p>There are a number of important options for the histogram. Arguably the most important one is to set the
          number of bins or,
          alternatively, the values for the cut points.</p>
        <p>The histogram options shown in Figure <a href="#fig:histoptions">5</a> are brought up in the usual fashion,
          by right clicking on the graph.</p>
        <div class="figure" style="text-align: center"><span id="fig:histoptions"></span>
          <img src="pics2a/1_hist_chooseint.png" alt="Choose intervals histogram option" width="20%" />
          <p class="caption">
            Figure 5: Choose intervals histogram option
          </p>
        </div>
        <div id="selecting-the-number-of-histogram-bins" class="section level4 unnumbered" number="">
          <h4>Selecting the number of histogram bins</h4>
          <p>The <strong>Choose Intervals</strong> option, shown in Figure <a href="#fig:histoptions">5</a>, allows for
            the customization
            of the number of bins in the histogram. A dialog appears that lets you set this value explicitly. The
            default is 7, but in our example, we change this to 5, as in Figure <a href="#fig:hist5option">6</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:hist5option"></span>
            <img src="pics2a/00_choose_intervals.png" alt="Histogram intervals set to 5" width="20%" />
            <p class="caption">
              Figure 6: Histogram intervals set to 5
            </p>
          </div>
          <p>The resulting histogram now has five bars, as in Figure <a href="#fig:hist5bars">7</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:hist5bars"></span>
            <img src="pics2a/00_histogram_5.png" alt="Histogram with 5 intervals" width="40%" />
            <p class="caption">
              Figure 7: Histogram with 5 intervals
            </p>
          </div>
          <p>This takes care of the problem of the bin with missing observations.</p>
        </div>
        <div id="using-a-custom-classification" class="section level4 unnumbered" number="">
          <h4>Using a custom classification</h4>
          <p>Recall how we created a custom map classification based on the range of values for
            <strong>kids2000</strong>, and
            labeled it <strong>custom1</strong>. If you have loaded the project file with the NYC data, then this custom
            classification
            will be listed as an option for <strong>Histogram Classification</strong>, as shown in Figure <a
              href="#fig:histcustom">8</a>.
            If you started from scratch, you will have to recreate the custom classification (for specifics, see the
            mapping chapter).</p>
          <div class="figure" style="text-align: center"><span id="fig:histcustom"></span>
            <img src="pics2a/00_custom_hist_class.png" alt="Selecting a custom histogram classification" width="35%" />
            <p class="caption">
              Figure 8: Selecting a custom histogram classification
            </p>
          </div>
          <p>The custom classification is the way <code>GeoDa</code> allows for cut points to be specified, instead of
            the
            number of bins.
            With <strong>custom1</strong> selected, the histogram takes the form as in Figure <a
              href="#fig:histcustom1">9</a>, with
            six bins, as defined by this classification. The histogram has the exact same shape as the one portrayed in
            the
            <strong>Category Editor</strong> interface when creating these custom categories.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:histcustom1"></span>
            <img src="pics2a/00_histogram_custom1.png" alt="Histogram with custom intervals" width="40%" />
            <p class="caption">
              Figure 9: Histogram with custom intervals
            </p>
          </div>
        </div>
        <div id="histograms-for-categorical-variables" class="section level4 unnumbered" number="">
          <h4>Histograms for categorical variables</h4>
          <p>The default logic behind the histogram is to consider the range of the variable of interest (max - min) and
            compute the cut points based on the specified number of bins. For categorical variables, this leads to
            undesirable results.</p>
          <p>To illustrate this, we create a map for <strong>kids2000</strong> with the <strong>custom1</strong>
            categories, and use <strong>Save Categories</strong>
            to create a categorical variable (say <strong>catkid20</strong>) for this classification.<a href="#fn2"
              class="footnote-ref" id="fnref2"><sup>2</sup></a> The default histogram for this variable is as in
            Figure <a href="#fig:histcat">10</a>, clearly not something that reflects the discrete integer values
            associated with the
            categories. Rather, the cut points are based on the range of 5, divided by the default number of bins of 7,
            or
            a bin width of approximately 0.7. Indeed, the first bin goes from 1 to 1.7.</p>
          <div class="figure" style="text-align: center"><span id="fig:histcat"></span>
            <img src="pics2a/00_hist_cat_default.png" alt="Default histogram for categorical variables" width="40%" />
            <p class="caption">
              Figure 10: Default histogram for categorical variables
            </p>
          </div>
          <p>The <strong>View</strong> option of the histogram provides a way to deal with categorical variables by
            means
            of the <strong>Set as Unique Value</strong> item, shown in Figure <a href="#fig:histunique">11</a>. This
            option recognizes
            the discrete nature of the categorical variable and adjusts the cut point accordingly.</p>
          <div class="figure" style="text-align: center"><span id="fig:histunique"></span>
            <img src="pics2a/00_hist_unique_option.png" alt="Selecting a unique value histogram classification"
              width="35%" />
            <p class="caption">
              Figure 11: Selecting a unique value histogram classification
            </p>
          </div>
          <p>The result is shown in Figure <a href="#fig:histcategory">12</a>, with six categories each associated with
            an identifying
            integer value.</p>
          <div class="figure" style="text-align: center"><span id="fig:histcategory"></span>
            <img src="pics2a/00_hist_category.png" alt="Unique value histogram for categorical variables" width="40%" />
            <p class="caption">
              Figure 12: Unique value histogram for categorical variables
            </p>
          </div>
        </div>
        <div id="display-histogram-statistics" class="section level4 unnumbered" number="">
          <h4>Display histogram statistics</h4>
          <p>An important option for the histogram (and any other statistical graph) is to be able to display
            descriptive statistics for the variable of interest. This is accomplished by selecting <strong>Display
              Statistics</strong> in the <strong>View</strong> option for the histogram (see Figure <a
              href="#fig:histunique">11</a>)</p>
          <p>This option adds a number of descriptors below the graph. The summary statistics are given at the bottom,
            illustrated in Figure <a href="#fig:histsummary">13</a> for <strong>kids2000</strong> with custom
            categories. We see that the 55 observations have a minimum value of 8.3815, a maximum of 55.3666, median of
            38.2278, mean of 36.04 and a standard deviation of 11.2881. In addition, for the histogram, descriptive
            statistics are provided for each interval, showing the range for the interval, the number of observations as
            a count and as a percentage of the total number of observations, and the number of standard deviations away
            from the mean for the center of the bin. This allows us to identify potential outliers, e.g., as defined by
            those observations more than two standard deviations from the mean. In our example, no category satisfies
            this criterion.</p>
          <p>The summary characteristics for a given bin also appear in the status bar when the cursor is moved over the
            corresponding bar. This works whether the descriptive statistics option is on or not. In our example in
            Figure <a href="#fig:histsummary">13</a>, the cursor is over the fourth category.</p>
          <div class="figure" style="text-align: center"><span id="fig:histsummary"></span>
            <img src="pics2a/00_hist_w_statistics.png" alt="Histogram with descriptive statistics" width="50%" />
            <p class="caption">
              Figure 13: Histogram with descriptive statistics
            </p>
          </div>
        </div>
        <div id="other-histogram-options" class="section level4 unnumbered" number="">
          <h4>Other histogram options</h4>
          <p>Other items available in the <strong>View</strong> option include customizing the precision of the axes and
            displayed statistics,
            respectively through <strong>View &gt; Set Display Precision on Axes</strong> and <strong>View &gt; Set
              Display Precision</strong>.</p>
          <p>In addition,
            standard options for the histogram include adjustments to various color settings (<strong>Color</strong>),
            saving the selection (similar to what we saw for the map functionality), <strong>Copy the Image to
              Clipboard</strong> and saving the graph as an
            image file (again, identical to the map functionality).</p>
        </div>
        <div id="linking-a-histogram-and-a-map" class="section level4 unnumbered" number="">
          <h4>Linking a histogram and a map</h4>
          <p>To illustrate the concept of <em>linked</em> graphs and maps, we continue with the custom histogram and
            make sure
            the default themeless map is available. When we select the two right-most bars in the histogram (click and
            shift-click to expand the selection), the highlighted bars keep their color, whereas the non-selected ones
            become transparent, as in the right-hand graph in Figure <a href="#fig:histmaplink">14</a>. This is the
            standard approach to visualize a selection in a graph in <code>GeoDa</code>.<a href="#fn3"
              class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
          <p>Immediately upon selection of the bars in the graph, the corresponding observations in the map are also
            highlighted, as in the left-hand graph in Figure <a href="#fig:histmaplink">14</a>. In our current example,
            the map is a simple themeless map (all areal units are green), but in more realistic applications, the map
            can be any type of choropleth map, for the same variable or for a different variable. The latter can be very
            useful in the exploration of categorical overlap between variables.</p>
          <div class="figure" style="text-align: center"><span id="fig:histmaplink"></span>
            <img src="pics2a/00_link_hist_map.png" alt="Linking a histogram and a map" width="80%" />
            <p class="caption">
              Figure 14: Linking a histogram and a map
            </p>
          </div>
          <p>The reverse linking works as well. For example, using a rectangular selection tool on the themeless map, we
            can select sub-boroughs in Manhattan and adjoining Brooklyn, as in the map in Figure
            <a href="#fig:maphistlink">15</a>. The linked
            histogram (right-hand graph in Figure <a href="#fig:maphistlink">15</a>) will show the attribute
            distribution for the selected spatial units as highlighted fractions of the bars (the transparent bars
            correspond to the unselected areal units).
          </p>
          <p>In practice, we will be interested in assessing the extent to which the
            distribution of the selected observations (e.g., a sub-region) matches the overall distribution.
            When it does not, this may reveal the presence of <em>spatial heterogeneity</em>, to which we return below.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:maphistlink"></span>
            <img src="pics2a/00_link_map_hist.png" alt="Linking a map and a histogram" width="80%" />
            <p class="caption">
              Figure 15: Linking a map and a histogram
            </p>
          </div>
          <p>As we have seen before, it is also possible to save the selection in the form of a 0-1 indicator variable
            with the <strong>Save Selection</strong> option.</p>
          <p>The technique of linking, and its dynamic counterpart of <em>brushing</em> (more later) is central to the
            data exploration philosophy that is behind <code>GeoDa</code> <span class="citation">(for a more elaborate
              exposition of the philosophy
              behind <code>GeoDa</code>, see Anselin, Syabri, and Kho <a href="#ref-Anselinetal:06a"
                role="doc-biblioref">2006</a>)</span>.</p>
        </div>
      </div>
      <div id="box-plot" class="section level3 unnumbered" number="">
        <h3>Box Plot</h3>
        <p>A box plot is an alternative visualization of the distribution of a single variable. It is invoked as
          <strong>Explore &gt; Box Plot</strong>, or by selecting the <strong>Box Plot</strong> as the second icon from
          the left in the toolbar, shown in
          Figure <a href="#fig:exploretool">2</a>.</p>
        <p>Identical to the approach followed for the histogram, next appears a <strong>Variable Settings</strong>
          dialog to select the variable. In <code>GeoDa</code>, the default is that the variable from any previous
          analysis is already selected. In our example, we change this to
          the variable <strong>rent2008</strong>, which we already encountered in the illustration of the box map in the
          mapping Chapter.</p>
        <p>The box plot for <strong>rent2008</strong> is shown in Figure <a href="#fig:boxplot">16</a> (make sure to
          turn <em>off</em> any previous selection of observations).</p>
        <div class="figure" style="text-align: center"><span id="fig:boxplot"></span>
          <img src="pics2a/11_boxplot_15.png" alt="Default box plot" width="30%" />
          <p class="caption">
            Figure 16: Default box plot
          </p>
        </div>
        <p>The box plot focuses on the quartiles of the distribution. The data points are sorted from small to large.
          The median (50 percent point) is represented by the horizontal orange bar in the middle of the distribution.
          The green dot above corresponds with the mean.</p>
        <p>The brown rectangle goes from the first quartile (25th percentile) to the third quartile (75th percentile).
          The difference between the values that
          correspond to the third (1362.5) and the first quartile (1000) is referred to as the <em>inter-quartile
            range</em> (IQR). The inter-quartile range is a measure of the spread of the distribution, a non-parametric
          counterpart to the standard deviation. In our example, the IQR is 362.5 (1362.5 - 1000).</p>
        <p>The horizontal lines drawn at the top and bottom of the
          graph are the so-called <em>fences</em> or <em>hinges</em>. They correspond to the values of the first
          quartile less 1.5xIQR (i.e., roughly 1000 - 362.5x1.5 = 275), and the third quartile plus 1.5xIQR
          (i.e., roughly 1362.5 + 362.5x1.5 = 2087.5). Observations that fall outside the fences are considered to
          be <em>outliers</em>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
        <p>In our example in Figure <a href="#fig:boxplot">16</a>, we have a single lower outlier value (corresponding
          to three
          observations), and six upper outlier observations.
          Note that the lower outliers are the observations that correspond with a value of 0
          (the minimum), which we earlier had flagged as potentially suspicious. The outlier detection would seem to
          confirm this. Checking for <em>strange</em> values that may possibly be coding
          errors or suggest other measurement problems is one of the very useful applications of
          a box plot.</p>
        <div id="box-plot-options" class="section level4 unnumbered" number="">
          <h4>Box plot options</h4>
          <p>The default in <code>GeoDa</code> is to list the summary statistics at the bottom of the box plot. As
            was the case for the histogram, the statistics
            include the minimum, maximum, mean, median and standard deviation. In addition, the values for the first and
            third quartile and the resulting IQR are given as well. The listing
            of descriptive statistics can be turned off by unchecking <strong>View &gt; Display Statistics</strong>
            (i.e., the
            default is the reverse of what held for the histogram, where the statistics had to be
            invoked explicitly).</p>
          <p>The typical multiplier for the IQR to determine outliers is 1.5 (roughly equivalent to the practice of
            using two standard deviations in a parametric setting). However, a value of 3.0 is fairly common as well,
            which considers only truly extreme observations as outliers. The multiplier to determine the fence can be
            changed with the <strong>Hinge &gt; 3.0</strong> option (right click in the plot to select the options menu,
            and
            then choose the hinge value, as in Figure <a href="#fig:boxhinge3option">17</a>).</p>
          <div class="figure" style="text-align: center"><span id="fig:boxhinge3option"></span>
            <img src="pics2a/2_156_changehinge.png" alt="Change the box plot hinge" width="25%" />
            <p class="caption">
              Figure 17: Change the box plot hinge
            </p>
          </div>
          <p>The resulting box plot, shown in Figure <a href="#fig:box3">18</a>, no longer characterizes the lowest
            value as an outlier.</p>
          <div class="figure" style="text-align: center"><span id="fig:box3"></span>
            <img src="pics2a/11_boxplot_3.png" alt="Box plot with hinge = 3.0" width="30%" />
            <p class="caption">
              Figure 18: Box plot with hinge = 3.0
            </p>
          </div>
          <p>The other options for the box plot can be seen in Figure <a href="#fig:boxhinge3option">17</a>. Except for
            the <strong>Hinge</strong> option,
            these are the same as for the histogram, and are not further considered here.</p>
          <p>Also, as is the case for any graph in <code>GeoDa</code>, linking and brushing are implemented, as already
            illustrated
            in the mapping Chapter.</p>
          <p>The main purpose of the box plot in an exploratory strategy is to identify outlier observations. We have
            already
            seen how that is implemented in the idea of a <em>box map</em> to show whether such outliers also coincide
            in space. In later
            Chapters, we will cover more formal methods to assess such patterns.</p>
        </div>
      </div>
    </div>
    <div id="bivariate-analysis-the-scatter-plot" class="section level2 unnumbered" number="">
      <h2>Bivariate Analysis: The Scatter Plot</h2>
      <div id="scatter-plot-basics" class="section level3 unnumbered" number="">
        <h3>Scatter Plot basics</h3>
        <div id="default-settings" class="section level4 unnumbered" number="">
          <h4>Default settings</h4>
          <p>The standard tool to assess a <em>linear</em> relationship between two variables is the
            scatter plot, a diagram with two axes, each corresponding to one of the variables. The
            observation (x, y) pairs are plotted as points in the diagram.</p>
          <p>We create a scatter plot by selecting <strong>Explore &gt; Scatter Plot</strong> from the menu, or by
            clicking on
            the matching toolbar icon, the third from the left in the EDA group on the toolbar, shown
            in Figure <a href="#fig:exploretool">2</a>.</p>
          <p>This brings up the <strong>Scatter Plot Variables</strong> dialog, where the variables for the X and Y axes
            need to be selected. In our example, illustrated in Figure <a href="#fig:scatvars">19</a>, we will choose
            the percentage of households with kids under age 18 in 2000 (<strong>kids2000</strong>) as the X-variable,
            and the percentage of households receiving public assistance (<strong>pubast00</strong>) as the Y-variable.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:scatvars"></span>
            <img src="pics2a/3_scatterplot_variables.png" alt="Scatter Plot variable selection" width="30%" />
            <p class="caption">
              Figure 19: Scatter Plot variable selection
            </p>
          </div>
          <p>Clicking <strong>OK</strong> brings up the scatter plot, shown in <a href="#fig:scatdefault">20</a>.</p>
          <div class="figure" style="text-align: center"><span id="fig:scatdefault"></span>
            <img src="pics2a/22_scatplot_default.png" alt="Default Scatter Plot" width="50%" />
            <p class="caption">
              Figure 20: Default Scatter Plot
            </p>
          </div>
          <p>The default view of the scatter plot is to use the variables in their original scales (i.e., not
            standardized), show the axes through zero (as dashed lines), and fit a linear smoother (i.e., a least
            squares regression fit). In our example in Figure <a href="#fig:scatdefault">20</a>, there is only a
            horizontal
            axis, since all the x values are larger than zero.</p>
          <p>In addition, at the bottom of the graph, several summary statistics are listed for the regression line.
            This includes the R<sup>2</sup> of the fit, and the estimate, standard error, t-statistic and p-value for
            both the intercept and the slope coefficient.</p>
          <p>In the current setup, no observations are selected, so that the second line in the statistical summary
            in Figure <a href="#fig:scatdefault">20</a> (all red zeros) has no values. This line pertains to the
            selected observations. The blue line at the bottom relates to the unselected observation. The sum of the
            number of observations in each of the two subsets always equals the total number of observations, listed on
            the top line. The three lines are listed because of the default <strong>View</strong> setting of
            <strong>Regimes Regression</strong>,
            even though there is currently no active selection (see also below).</p>
        </div>
        <div id="scatter-plot-options" class="section level4 unnumbered" number="">
          <h4>Scatter Plot options</h4>
          <p>The scatter plot has several interesting options, many of which are listed in Figure <a
              href="#fig:scatoptions">21</a>, with a
            focus on the <strong>View</strong> items. As usual, the list of options is brought up by right clicking in
            the graph window or by selecting <strong>Options</strong> in the menu.</p>
          <div class="figure" style="text-align: center"><span id="fig:scatoptions"></span>
            <img src="pics2a/22_scatplot_options.png" alt="Scatter Plot options" width="35%" />
            <p class="caption">
              Figure 21: Scatter Plot options
            </p>
          </div>
          <p>The <strong>View</strong> option shows the default settings with the <strong>Statistics</strong> displayed
            below the graph, the <strong>Axes Through Origin</strong> shown as dashed lines, and the <strong>Status
              Bar</strong> active. Two
            other default settings are to have a <strong>Fixed Aspect Ratio</strong> and <strong>Regimes
              Regression</strong>
            active. When some observations are selected, the regimes regression setting will result in
            the computation of three different linear smoothers. We revisit this when we consider brushing the scatter
            plot.</p>
          <p>Several of the other options should by now be familiar, such as the <strong>Selection Shape</strong>,
            <strong>Color</strong>, <strong>Save Selection</strong> and the two ways to save the image. In addition, as
            before, we can set the precision for the axes and the display itself. We do not further discuss these
            options again.</p>
        </div>
        <div id="correlation" class="section level4 unnumbered" number="">
          <h4>Correlation</h4>
          <p>The <strong>Data</strong> option provides a choice between the variables on their original scale (the
            default) and the use of standardized variables. Note that when you use the standardized form, by means of
            <strong>Data &gt; View Standardized Data</strong>, the slope of the linear smoother (0.688) is also the
            <em>correlation coefficient</em> between the two variables, as in Figure <a href="#fig:scatstandard">22</a>.
            In all other respects, the look of the scatter plot is the same as before.
          </p>
          <div class="figure" style="text-align: center"><span id="fig:scatstandard"></span>
            <img src="pics2a/22_scatplot_standard.png" alt="Scatter Plot for standardized values -- correlation"
              width="50%" />
            <p class="caption">
              Figure 22: Scatter Plot for standardized values – correlation
            </p>
          </div>
        </div>
      </div>
      <div id="smoothing-the-scatter-plot" class="section level3 unnumbered" number="">
        <h3>Smoothing the scatter plot</h3>
        <p>The default setting is to implement a linear regression fit to the scatter plot points. An alternative that
          is better at exploring local nonlinearities is a so-called <em>local</em> regression fit. A local regression
          fit is
          a nonlinear procedure that computes the slope from a subset of observations on a small interval on the
          X-axis. In addition, values further removed from the center of the interval may be weighted down (similar to a
          kernel smoother). As the interval (the bandwidth) moves over the full range of observations, the different
          slopes
          are combined into a smooth curve <span class="citation">(for a detailed overview of the methodological
            issues, see, e.g., Cleveland <a href="#ref-Cleveland:79" role="doc-biblioref">1979</a>; and Loader <a
              href="#ref-Loader:99" role="doc-biblioref">1999</a>, <a href="#ref-Loader:04"
              role="doc-biblioref">2004</a>)</span>.</p>
        <p>A nonlinear local regression fit reveals potential nonlinearities in the bivariate relationship and may
          suggest the presence of structural breaks. Two common implementations are LOWESS, locally weighted scatter
          plot smoother, and LOESS, a local polynomial regression
          (the two are often confused, but implement different fitting algorithms).</p>
        <p>In <code>GeoDa</code>, LOWESS is
          implemented. It is selected in the <strong>Smoother</strong> option,
          as shown in Figure <a href="#fig:smoothoption">23</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:smoothoption"></span>
          <img src="pics2a/4_scatter_smoother_options.png" alt="Scatter Plot smoothing options" width="30%" />
          <p class="caption">
            Figure 23: Scatter Plot smoothing options
          </p>
        </div>
        <p>Selecting the <strong>Show LOWESS Smoother</strong> option adds the nonlinear fit to the scatter plot. Note
          that by default the <strong>Show Linear Smoother</strong> option remains checked, so that this needs to be
          unchecked to see only the nonlinear fit. The graph is illustrated in Figure <a
            href="#fig:smoothwlinear">24</a>, after returning to the original scale of the data. In addition,
          <strong>View &gt; Statistics</strong> setting was turned off as well, since that pertains to the linear fit.
        </p>
        <p>In practice, having both types of smoothing present on the plot
          facilitates an easy comparison of the two curve fits.</p>
        <div class="figure" style="text-align: center"><span id="fig:smoothwlinear"></span>
          <img src="pics2a/22_lowess_default.png" alt="Default LOWESS smoother" width="50%" />
          <p class="caption">
            Figure 24: Default LOWESS smoother
          </p>
        </div>
        <p>In our example, there is considerable evidence of a nonlinear relationship between the two variables. An
          alternative interpretation is to see this as an indication of a structural break, where in one subset of the
          data the slope is very steep, whereas in another it is fairly flat.</p>
        <div id="lowess-parameters" class="section level4 unnumbered" number="">
          <h4>LOWESS parameters</h4>
          <p>The nonlinear fit is driven by a number of parameters, the most important of which is the
            <em>bandwidth</em>, i.e., the
            range of values on the X-axis on which the local slope estimate is based.</p>
          <p>The smoothing parameters can be changed in the options by selecting <strong>Edit LOWESS Parameters</strong>
            in the <strong>Smoother</strong> option. As shown in Figure <a href="#fig:bandwidth">25</a>, a small dialog
            is brought up in which the <strong>Bandwidth</strong> (default setting 0.20), <strong>Iterations</strong>
            and <strong>Delta Factor</strong> can be adjusted.</p>
          <div class="figure" style="text-align: center"><span id="fig:bandwidth"></span>
            <img src="pics2a/22_smooth_options.png" alt="LOWESS bandwidth settings" width="20%" />
            <p class="caption">
              Figure 25: LOWESS bandwidth settings
            </p>
          </div>
          <p>The bandwidth determines the smoothness of the curve and is given as a fraction of the total range in X
            values. In other words, the default bandwidth of 0.20 implies that for each local fit (centered on a value
            for X), about one fifth of the scatter points are taken into account. The other options are technical and
            are best left
            to their default values.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
          <p>To obtain Figure <a href="#fig:smooth40">26</a>, we changed the bandwidth to 0.50, which results in a much
            smoother curve that brings out a possible structural break in the data in a more striking fashion.</p>
          <div class="figure" style="text-align: center"><span id="fig:smooth40"></span>
            <img src="pics2a/22_lowess_50.png" alt="LOWESS smoother bandwidth 0.40" width="50%" />
            <p class="caption">
              Figure 26: LOWESS smoother bandwidth 0.40
            </p>
          </div>
          <p>The plot seems to suggest that the linear fit is really a compromise between two slopes. There is a steep
            slope for observations with a value for households with children above 40 percent, suggesting a major
            increase in public assistance with every increase in the percentage children. With values for
            <strong>kids2000</strong> below 40, the slope is much gentler and even flat in small subsets of the data.
          </p>
          <p>The opposite effect is obtained when the bandwidth is made smaller. For example, with a value of 0.10, the
            resulting curve in Figure <a href="#fig:smooth10">27</a> is much more jagged and less informative.</p>
          <div class="figure" style="text-align: center"><span id="fig:smooth10"></span>
            <img src="pics2a/22_lowess_10.png" alt="LOWESS smoother bandwidth 0.10" width="50%" />
            <p class="caption">
              Figure 27: LOWESS smoother bandwidth 0.10
            </p>
          </div>
          <p>The literature contains many discussions of the notion of an optimal bandwidth, but in practice a trial and
            error approach is often more effective. In any case, a value for the bandwidth that follows one of these
            rules of thumb can be entered in the dialog. Currently, <code>GeoDa</code> does not compute optimal
            bandwidth values.</p>
          <p>Finally, while one might expect the LOWESS fit and a linear fit to coincide with a bandwidth of 1.0,
            this is not the case. The LOWESS fit will be near-linear, but slightly different from a standard
            least squares result due to the locally weighted nature of the algorithm.</p>
        </div>
      </div>
    </div>
    <div id="spatial-heterogeneity" class="section level2 unnumbered" number="">
      <h2>Spatial Heterogeneity</h2>
      <p>Spatial heterogeneity is one of the most important aspects of a spatial analysis of the data.
        In essence, its presence suggests that different distributions drive the observed sample.
        This is evidenced in the form of structural breaks, such as different mean or median values
        in different subsets of the data, or different slopes in a bivariate regression over observations in those
        subsets.</p>
      <p>The <em>spatial</em> aspect comes from the nature of the subsets in the data, which are spatially defined.
        Examples are the difference between center and periphery, east and west, north and south, etc.
        In <code>GeoDa</code>, the selection tool applied to a map allows us to assess the degree of heterogeneity
        in different spatial subsets of the data.</p>
      <p>We have already seen in the mapping Chapter how a selection in any of the views results in the same observation
        to immediately be selected in all other views through <em>linking</em>. <em>Brushing</em> is a dynamic extension
        of this process
        <span class="citation">(for some early exposition and discussion of these
          ideas pertaining to so-called dynamic graphics, see, e.g., the classic references of Stuetzle <a
            href="#ref-Stuetzle:87" role="doc-biblioref">1987</a>; Becker and Cleveland <a
            href="#ref-BeckerCleveland:87" role="doc-biblioref">1987</a>; Becker, Cleveland, and Wilks <a
            href="#ref-Beckeretal:87" role="doc-biblioref">1987</a>; Monmonier <a href="#ref-Monmonier:89"
            role="doc-biblioref">1989</a>; as
          well as in the outline of legacy <code>GeoDa</code> functionality in Anselin, Syabri, and Kho <a
            href="#ref-Anselinetal:06a" role="doc-biblioref">2006</a>)</span>.
      </p>
      <p>Here, we will cover two particular implementations that are of interest in the context of
        spatial heterogeneity, one focused
        on differences in the mean, the other on differences in the regression slope.</p>
      <div id="averages-chart" class="section level3 unnumbered" number="">
        <h3>Averages Chart</h3>
        <p>The <strong>Averages Chart</strong> is an implementation of a simple test on the difference in means between
          selected
          and unselected observations. Its most meaningful use is in the context of observations at different points
          in time, but it is equally applicable in a cross-sectional setting, illustrated here.</p>
        <p>The core functionality of this chart is to illustrate and quantify the difference between the
          mean of a variable for <em>selected</em> observations and <em>unselected</em> observations (the complement).
          In <code>GeoDa</code>, this is not implemented as a traditional t-test, but rather as an F-statistic for
          a regression that includes an indicator variable for the selection (i.e., value = 1 for selected,
          and zero otherwise). The F-statistic on the significance of the joint slopes in that regression is
          equivalent to a t-test on the coefficient of the indicator variable, since there is only one
          slope.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
        <p>The functionality is invoked from the menu as <strong>Explore &gt; Averages Chart</strong>, or from the
          toolbar, by
          selecting the second icon from the right, as in Figure <a href="#fig:avgcharticon">28</a>.</p>
        <div class="figure" style="text-align: center"><span id="fig:avgcharticon"></span>
          <img src="pics2a/33_avgchart_icon.png" alt="Averages Chart toolbar icon" width="10%" />
          <p class="caption">
            Figure 28: Averages Chart toolbar icon
          </p>
        </div>
        <p>The averages chart interface, shown in Figure <a href="#fig:avgchartstart">29</a>, requires that a variable
          be specified,
          as well as a selection of observations. The starting value shows the first variable in the data table, which
          is
          usually not informative. In the example in Figure <a href="#fig:avgchartstart">29</a>, we have selected
          <strong>rent2008</strong>, as
          shown next to <strong>Variable</strong> in the upper left corner of the dialog. Since there is currently no
          selection, the
          <strong>Group</strong> shown as <strong>Selected</strong> has <strong>0</strong> observations, and a
          <strong>Mean</strong> of <strong>0.00</strong>. In contrast, the <strong>Unselected</strong>
          consists of all 55 observations and its mean is the overall average for the rent values. In the graph on
          the right, the selected mean is given in red, and the unselected in blue. As it stands, this figure is not
          very useful, since we need to create a selection.
        </p>
        <div class="figure" style="text-align: center"><span id="fig:avgchartstart"></span>
          <img src="pics2a/33_avgchart_start.png" alt="Averages Chart with variable selected" width="60%" />
          <p class="caption">
            Figure 29: Averages Chart with variable selected
          </p>
        </div>
        <p>We select all the observations for Manhattan. This is straightforward by means of the <strong>Selection
            Tool</strong> in the data table.
          As it turns out, all the sub-boroughs in Manhattan have a value for <strong>bor_subb</strong> between 301 and
          310, which provides
          an easy way to select them. With that selection in place, the values in the averages chart are immediately
          adjusted, as shown in Figure <a href="#fig:avgchartmanbronx">30</a>. In the updated dialog, the
          <strong>Selected</strong> consist of 10
          observations, with a mean rent of 2062.5, which contrasts with the mean for the <strong>Unselected</strong> of
          1078.22. In the
          graph on the right, again, the selected mean is shown as the red bar and the unselected one as the blue bar.
          In the
          middle, as a black bar, is the overall mean (for all the observations).</p>
        <p>At this point, the result for an F-test on the slope of the dummy variable regression is available as well.
          The statistic
          has a value of 37.63, for 1, 53 degrees of freedom, which yields a highly significant
          p-value of 0.000.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> Note that this statistic
          does not account for heteroskedasticity or the potential presence of spatial autocorrelation, which is beyond
          our current scope.</p>
        <p>The averages chart provides an easy method to test for the difference in means between two subsets of the
          data.
          This becomes a test for <em>spatial heterogeneity</em> when the selected subsets are <em>spatial</em> in
          nature. In our current
          example, we obtained a spatial selection by coincidence (by selecting on the id-values for Manhattan). Next,
          we consider
          a true spatial selection.</p>
        <div class="figure" style="text-align: center"><span id="fig:avgchartmanbronx"></span>
          <img src="pics2a/33_avgchart_manbronx.png" alt="Averages Chart for rent2008 with Manhattan-The Bronx"
            width="60%" />
          <p class="caption">
            Figure 30: Averages Chart for rent2008 with Manhattan-The Bronx
          </p>
        </div>
        <div id="map-brushing-and-the-averages-chart" class="section level4 unnumbered" number="">
          <h4>Map brushing and the Averages Chart</h4>
          <p>The real power to assess <em>spatial</em> heterogeneity in the means comes from employing the brush in a
            map.
            As the dynamic version of linking, the brush (e.g., a rectangle) is moved over the map and continuously
            updates the
            selection of observations. As soon as the brush stops moving, the test on the difference in means is updated
            in
            the averages chart, allowing us to assess for which subregions the differences are the greatest.</p>
          <p>For example, in Figure <a href="#fig:avgchartbrush1">31</a>, we start with a selection in the lower right
            of the map, covering
            parts of Queens and Brooklyn. The respective average rents are 1150 for the 21 selected observations (red
            bar, below the
            overall mean), and 1323.38 for the 34
            unselected (blue). The difference between the two is insufficient to yield a significant F-test. With a
            statistic
            of 1.11, the associated p-value is 0.298, insufficient to reject the null hypothesis of equality of the
            means.</p>
          <div class="figure" style="text-align: center"><span id="fig:avgchartbrush1"></span>
            <img src="pics2a/33_selectmap_avg1.png" alt="Brushing with the Averages Chart (1)" width="90%" />
            <p class="caption">
              Figure 31: Brushing with the Averages Chart (1)
            </p>
          </div>
          <p>As we move the brush west and north, the situation changes. Now, the mean for the 22 selected observations
            of
            1517.05 (red bar) is above the overall mean, and compares for an average of 1083.94 for the 33 unselected
            observations.
            The F statistic of 7.90 obtains a p-value of 0.007, clearly rejecting the null hypothesis and indicating
            spatial
            heterogeneity in the means.</p>
          <div class="figure" style="text-align: center"><span id="fig:avgchartbrush2"></span>
            <img src="pics2a/33_selectmap_avg2.png" alt="Brushing with the Averages Chart (2)" width="90%" />
            <p class="caption">
              Figure 32: Brushing with the Averages Chart (2)
            </p>
          </div>
        </div>
      </div>
      <div id="brushing-the-scatter-plot" class="section level3 unnumbered" number="">
        <h3>Brushing the Scatter Plot</h3>
        <p>The concept of <em>brushing</em> was initially suggested in the context of a scatter plot <span
            class="citation">(Stuetzle <a href="#ref-Stuetzle:87" role="doc-biblioref">1987</a>)</span>, and extended
          to the map context by <span class="citation">Monmonier (<a href="#ref-Monmonier:89"
              role="doc-biblioref">1989</a>)</span>. The architecture linking all open windows simultaneously is
          fundamental
          to the design of <code>GeoDa</code> <span class="citation">(Anselin, Syabri, and Kho <a
              href="#ref-Anselinetal:06a" role="doc-biblioref">2006</a>)</span>.</p>
        <p>We illustrate brushing of the scatter plot with the example of <strong>kids2000</strong> and
          <strong>pubast00</strong>, intitialized
          in Figures <a href="#fig:scatvars">19</a> and <a href="#fig:scatdefault">20</a>. We initiate the brushing
          process by setting
          up a selection shape in the scatter plot. The default is a rectangular shape, but we have seen earlier how
          that can be changed to a circle or a line. In our example, we keep the default.</p>
        <p>We click at a given location
          in the scatter plot and draw the pointer into a rectangular shape, as shown in Figure <a
            href="#fig:brushscat1">33</a>. Note how the pointer is attached to a corner of the rectangle. At this point,
          the shape can be moved around in the view, dynamically changing the selection.</p>
        <div class="figure" style="text-align: center"><span id="fig:brushscat1"></span>
          <img src="pics2a/44_brush_scat1.png" alt="Brushing the scatter plot -- 1" width="50%" />
          <p class="caption">
            Figure 33: Brushing the scatter plot – 1
          </p>
        </div>
        <p>In our example, we have selected 22 observations. The purple line represents the original linear fit, the red
          line is the fit for the 22 selected observations, and the blue line is the fit for the other 33 observations.
          Below the three lines with the slope coefficients and fit statistics, the results
          are listed of a Chow test on structural stability are listed <span class="citation">(Chow <a
              href="#ref-Chow:60" role="doc-biblioref">1960</a>)</span>.<a href="#fn8" class="footnote-ref"
            id="fnref8"><sup>8</sup></a> Clearly, in contrast to the overall purple and the blue line, there is no
          relationship at all for the selected observations in question, as evidenced by the horizontal red line. The
          Chow test confirms this by strongly rejecting (p &lt; 0.0005) the null hypothesis of equal coefficients
          (between the slopes of the blue and the red lines).</p>
        <p>Because of the linking, the 22 selected observations are also highlighted in all the other views. Such views
          could
          pertain to the same or to different variables, allowing us to investigate potential interaction effects.</p>
        <p>With the <strong>Regimes Regression</strong> option turned on, the three linear fits change instantaneously
          as different observations are selected. Of course, the fits themselves are only meaningful when sufficient
          observations are part of the selection. For example, we can move the selection rectangle up and to the right,
          as in Figure <a href="#fig:brushscat2">34</a>, which yields a new selection of 11 observations, with
          associated regression lines. This time, there is insufficient evidence to reject the null hypothesis (Chow
          test with p = 0.9513).</p>
        <div class="figure" style="text-align: center"><span id="fig:brushscat2"></span>
          <img src="pics2a/55_brush_scat2.png" alt="Brushing the scatter plot -- 2" width="50%" />
          <p class="caption">
            Figure 34: Brushing the scatter plot – 2
          </p>
        </div>
        <p>Again, the matching selected locations are shown in all the other current views.</p>
        <div id="map-brushing-and-scatter-plot" class="section level4 unnumbered" number="">
          <h4>Map brushing and scatter plot</h4>
          <p>Similar to what we saw for the averages chart,
            a powerful assessment of potential spatial heterogeneity in a bivariate linear regression is based on
            brushing a map, linked to a scatter plot.</p>
          <p>As before, we start by making a selecting in a map. For example, in Figure <a href="#fig:brushmap3">35</a>,
            17 observations are selected. This selection is reflected in a new set of slopes in the scatter plot. In
            this case, the difference between
            the red (selected) and blue (unselected) slopes is insufficient to lead to a rejection of the null
            hypothesis by
            means of the Chow test (a p-value of 0.1693).</p>
          <div class="figure" style="text-align: center"><span id="fig:brushmap3"></span>
            <img src="pics2a/55_brushmap_scat1.png" alt="Brushing a map linked to a scatter plot -- 1" width="90%" />
            <p class="caption">
              Figure 35: Brushing a map linked to a scatter plot – 1
            </p>
          </div>
          <p>As we brush across the map, we can assess the degree to which the linear relationship is stable. Any
            systematically changing slopes between clearly defined sub-regions of the observations would suggest the
            presence of spatial heterogeneity.</p>
          <p>For example, moving
            the selection rectangle to the north and west, as in Figure <a href="#fig:brushmap4">36</a>, makes the
            evidence for structural change much stronger,
            as evidenced by the Chow test with p &lt; 0.0005.</p>
          <div class="figure" style="text-align: center"><span id="fig:brushmap4"></span>
            <img src="pics2a/55_brushmap_scat2.png" alt="Brushing the map -- 2" width="90%" />
            <p class="caption">
              Figure 36: Brushing the map – 2
            </p>
          </div>
          <p>As we identify subregions in the data with a different slope (structure) from the rest,
            we can assess this more formally through regression analysis (e.g., analysis of variance). This
            is facilitated by <strong>Saving</strong> the selection in the form of an indicator variable (with 1 for the
            selected observations).</p>
          <p>The new variable can then be incorporated in a regression specification, potentially interacting with other
            explanatory variables, to more formally address <em>spatial regimes</em>.<a href="#fn9" class="footnote-ref"
              id="fnref9"><sup>9</sup></a></p>
        </div>
      </div>
    </div>
    <div id="references" class="section level2 unnumbered" number="">
      <h2>References</h2>
      <div id="refs" class="references hanging-indent">
        <div id="ref-AnselinRey:14">
          <p>Anselin, Luc, and Sergio J. Rey. 2014. <em>Modern Spatial Econometrics in Practice, a Guide to Geoda,
              Geodaspace and Pysal</em>. Chicago, IL: GeoDa Press.</p>
        </div>
        <div id="ref-Anselinetal:06a">
          <p>Anselin, Luc, Ibnu Syabri, and Youngihn Kho. 2006. “GeoDa, an Introduction to Spatial Data Analysis.”
            <em>Geographical Analysis</em> 38: 5–22.</p>
        </div>
        <div id="ref-BeckerCleveland:87">
          <p>Becker, Richard A., and W. S. Cleveland. 1987. “Brushing Scatterplots.” <em>Technometrics</em> 29: 127–42.
          </p>
        </div>
        <div id="ref-Beckeretal:87">
          <p>Becker, Richard A., W. S. Cleveland, and A. R. Wilks. 1987. “Dynamic Graphics for Data Analysis.”
            <em>Statistical Science</em> 2: 355–95.</p>
        </div>
        <div id="ref-Chow:60">
          <p>Chow, G. 1960. “Tests of Equality Between Sets of Coefficients in Two Linear Regressions.”
            <em>Econometrica</em> 28: 591–605.</p>
        </div>
        <div id="ref-Cleveland:79">
          <p>Cleveland, William S. 1979. “Robust Locally Weighted Regression and Smoothing Scatterplots.” <em>Journal of
              the American Statistical Association</em> 74: 829–36.</p>
        </div>
        <div id="ref-Loader:99">
          <p>Loader, Catherine. 1999. <em>Local Regression and Likelihood</em>. Heidelberg: Springer-Verlag.</p>
        </div>
        <div id="ref-Loader:04">
          <p>———. 2004. “Smoothing: Local Regression Techniques.” In <em>Handbook of Computational Statistics: Concepts
              and Methods</em>, edited by James E. Gentle, Wolfgang Härdle, and Yuichi Mori, 539–63. Berlin:
            Springer-Verlag.</p>
        </div>
        <div id="ref-Monmonier:89">
          <p>Monmonier, Mark. 1989. “Geographic Brushing: Enhancing Exploratory Analysis of the Scatterplot Matrix.”
            <em>Geographical Analysis</em> 21: 81–84.</p>
        </div>
        <div id="ref-Stuetzle:87">
          <p>Stuetzle, W. 1987. “Plot Windows.” <em>Journal of the American Statistical Association</em> 82: 466–75.</p>
        </div>
      </div>
    </div>
    <div class="footnotes">
      <hr />
      <ol>
        <li id="fn1">
          <p>University of Chicago, Center for Spatial Data Science – <a href="mailto:anselin@uchicago.edu"
              class="email">anselin@uchicago.edu</a><a href="#fnref1" class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn2">
          <p>Consult the mapping chapter if you are unsure of how to accomplish this.<a href="#fnref2"
              class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn3">
          <p>In the <strong>GeoDa Preference Setup</strong>, under <strong>System</strong>, the transparency of the
            unhighlighted objects in a selection operation can be adjusted. The default is 0.80, which means only about
            20% of the regular color is shown.<a href="#fnref3" class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn4">
          <p>Note that the fences are drawn even when they fall outside
            the actual range of the observations. This will be the case whenever
            the value of the third quartile + 1.5xIQR is larger than the maximum,
            (as in in Figure <a href="#fig:boxplot">16</a>), or when the value of the first quartile - 1.5xIQR is
            smaller than the
            minimum.<a href="#fnref4" class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn5">
          <p>The LOWESS algorithm is complex and uses a weighted local polynomial fit.
            The <strong>Iterations</strong> setting determines how many times the fit is adjusted by refining the
            weights. A
            smaller value for this option will speed up computation, but result in a less robust fit. The
            <strong>Delta Factor</strong> drops points from the calculation of the local fit if they are too close
            (within
            Delta) to speed up the computations. Technical details are covered in <span class="citation">Cleveland (<a
                href="#ref-Cleveland:79" role="doc-biblioref">1979</a>)</span>.<a href="#fnref5"
              class="footnote-back">↩︎</a>
          </p>
        </li>
        <li id="fn6">
          <p>The F-statistic is basically a test on whether there is a significant gain in explanation
            in the regression beyond the overall mean (i.e., the constant term). Formally, the statistic uses
            the sum of squared residuals in the regression RSS and the sum of squared deviations from the
            mean for the dependent variable RSY. The statistic follows as:
            <span class="math display">\[F = \frac{RSS - RSY}{k - 1} / \frac{RSY}{n - k},\]</span>
            with <span class="math inline">\(k\)</span> as the number of explanatory variables. In our simple dummy
            variable regression,
            <span class="math inline">\(k = 2\)</span>, so that the degrees of freedom for the F-statistic are <span
              class="math inline">\(1, n-2\)</span>. See also <span class="citation">Anselin and Rey (<a
                href="#ref-AnselinRey:14" role="doc-biblioref">2014</a>)</span>,
            pp. 98-99.<a href="#fnref6" class="footnote-back">↩︎</a>
          </p>
        </li>
        <li id="fn7">
          <p>Since the first degree of freedom of the F-test in this case is always 1, it is not reported.
            Therefore, the entry for <strong>D.F.</strong> is 53, which corresponds to n - k = 55 - 2.<a href="#fnref7"
              class="footnote-back">↩︎</a></p>
        </li>
        <li id="fn8">
          <p>The Chow test is based on a comparison of the fit in the overall regression to the combination of the fits
            of the separate regressions, while taking into account the number of regressors (k). In our simple example,
            there is only the intercept and the slope, so k = 2. We compute the residual sum of squares for the full
            regression (<span class="math inline">\(\mbox{RSS}\)</span>) and for the two subsets, say <span
              class="math inline">\(\mbox{RSS}_1\)</span> and <span class="math inline">\(\mbox{RSS}_2\)</span>. Then,
            the Chow test follows as:
            <span class="math display">\[C = \frac{(\mbox{RSS} - (\mbox{RSS}_1 + \mbox{RSS}_2))/k}{(\mbox{RSS}_1 +
              \mbox{RSS}_2)/(n - 2k)},\]</span> distributed
            as an F statistic with <span class="math inline">\(k\)</span> and <span class="math inline">\(n -
              2k\)</span> degrees of freedom. Alternatively, the statistic can also be expressed as having a chi-squared
            distribution, which is more appropriate when multiple breaks and several coefficients are considered.
            Technical details are given in <span class="citation">Anselin and Rey (<a href="#ref-AnselinRey:14"
                role="doc-biblioref">2014</a>)</span>, pp. 287-289.<a href="#fnref8" class="footnote-back">↩︎</a>
          </p>
        </li>
        <li id="fn9">
          <p>the treatment of spatial regimes is beyond
            our current scope. For a detailed technical discussion, see <span class="citation">Anselin and Rey (<a
                href="#ref-AnselinRey:14" role="doc-biblioref">2014</a>)</span>, part IV.<a href="#fnref9"
              class="footnote-back">↩︎</a></p>
        </li>
      </ol>
    </div>


  </section>


  <!-- code folding -->


  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>

</html>